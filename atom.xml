<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[ç‹è‹¥é£çš„å°çª]]></title>
  <link href="http://wangruofeng.github.io/atom.xml" rel="self"/>
  <link href="http://wangruofeng.github.io/"/>
  <updated>2016-01-13T04:36:58+08:00</updated>
  <id>http://wangruofeng.github.io/</id>
  <author>
    <name><![CDATA[Ace]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[åŠ¨ç”»ç»˜åˆ¶CAShapeLayerçš„è·¯å¾„CGPath]]></title>
    <link href="http://wangruofeng.github.io/blog/2016/01/13/dong-hua-hui-zhi-cashapelayerde-lu-jing-cgpath/"/>
    <updated>2016-01-13T04:35:42+08:00</updated>
    <id>http://wangruofeng.github.io/blog/2016/01/13/dong-hua-hui-zhi-cashapelayerde-lu-jing-cgpath</id>
    <content type="html"><![CDATA[<h1>Animating the Drawing of a CGPath With CAShapeLayer</h1>

<ul>
<li><a href="http://oleb.net/blog/2010/12/animating-drawing-of-cgpath-with-cashapelayer/">åŸæ–‡é“¾æ¥</a></li>
</ul>


<h1>è¿™æ˜¯ä»€ä¹ˆï¼Ÿ</h1>

<blockquote><p>æ­¤æ–‡å°†è®²è§£é€šè¿‡å½¢çŠ¶å›¾å±‚<code>CAShaperLayer</code>çš„<code>strokeStart</code>å’Œ<code>strokeEnd</code>æ¥å®ç°åŠ¨ç”»ç»˜åˆ¶è·¯å¾„<code>CGPath</code>,æ­¤æ–‡æ˜¯<a href="http://oleb.net">By Ole Begemann</a>åˆ›å»ºäºDecember 18, 2010,å½“æ—¶æ˜¯å‘å¸ƒiOS SDK 4.2æ—¶<code>CAShapeLayer</code>æ–°å¢åŠ çš„ä¸¤ä¸ªå±æ€§<a href="http://developer.apple.com/library/ios/documentation/GraphicsImaging/Reference/CAShapeLayer_class/Reference/Reference.html#//apple_ref/doc/uid/TP40008314-CH1-SW16">strokeStart</a>å’Œ<a href="http://developer.apple.com/library/ios/documentation/GraphicsImaging/Reference/CAShapeLayer_class/Reference/Reference.html#//apple_ref/doc/uid/TP40008314-CH1-SW15">strokeEnd</a>,è¿™ä¸¤ä¸ªå€¼æ˜¯ä¸¤ä¸ªæµ®ç‚¹æ•°å–å€¼èŒƒå›´0.0~1.0,ç”¨æ¥è¡¨æ˜å½¢çŠ¶å›¾å±‚æ‰€æŒ‡å‘çš„è·¯å¾„åœ¨ç»˜åˆ¶å¼€å§‹å’Œç»“æŸè·¯å¾„ä¸­çš„ç›¸å¯¹ä½ç½®ã€‚</p></blockquote>

<p><code>strokeStart</code>é»˜è®¤å€¼æ˜¯0.0ï¼Œ<code>strokeEnd</code>é»˜è®¤å€¼æ˜¯1.0ï¼Œæ˜¾ç„¶è¿™ä¼šå¯¼è‡´å½¢çŠ¶å›¾å±‚çš„è·¯å¾„å°†ä¸€æ•´ä¸ªè¢«ç»˜åˆ¶ã€‚å‡å¦‚ï¼Œä½ æƒ³è¯´ï¼Œå¦‚æœè®¾ç½®äº†layer.strokeEnd = 0.5f,åªè®©å¥¹ç»˜åˆ¶å‰åŠéƒ¨åˆ†ï¼Œé‚£è¯¥å¤šå¥½ã€‚</p>

<p>çœŸæ­£æœ‰è¶£çš„äº‹æƒ…æ˜¯è¿™äº›æ¥å£éƒ½æ˜¯å¯åŠ¨ç”»çš„ã€‚é€šè¿‡åŠ¨ç”»ç»˜åˆ¶<code>strokeEnd</code>ä»0.0åˆ°1.0åœ¨å‡ ç§’å†…ï¼Œæˆ‘ä»¬å°±èƒ½å¾ˆå®¹æ˜“è‡ªå·±ç»˜åˆ¶è·¯å¾„åƒä¸‹é¢è¿™æ ·å†™ï¼š</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="bp">CABasicAnimation</span> <span class="o">*</span><span class="n">pathAnimation</span> <span class="o">=</span> <span class="p">[</span><span class="bp">CABasicAnimation</span> <span class="nl">animationWithKeyPath</span><span class="p">:</span><span class="s">@&quot;strokeEnd&quot;</span><span class="p">];</span>
</span><span class='line'><span class="n">pathAnimation</span><span class="p">.</span><span class="n">duration</span> <span class="o">=</span> <span class="mf">10.0</span><span class="p">;</span>
</span><span class='line'><span class="n">pathAnimation</span><span class="p">.</span><span class="n">fromValue</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSNumber</span> <span class="nl">numberWithFloat</span><span class="p">:</span><span class="mf">0.0f</span><span class="p">];</span>
</span><span class='line'><span class="n">pathAnimation</span><span class="p">.</span><span class="n">toValue</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSNumber</span> <span class="nl">numberWithFloat</span><span class="p">:</span><span class="mf">1.0f</span><span class="p">];</span>
</span><span class='line'><span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">pathLayer</span> <span class="nl">addAnimation</span><span class="p">:</span><span class="n">pathAnimation</span> <span class="nl">forKey</span><span class="p">:</span><span class="s">@&quot;strokeEndAnimation&quot;</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<p>æœ€åï¼Œå†æ·»åŠ ç¬¬äºŒä¸ªå›¾å±‚åŒ…å«ä¸€ä¸ªé“…ç¬”å›¾ç‰‡ï¼Œä½¿ç”¨å…³é”®å¸§åŠ¨ç”»<code>CAKeyframeAnimation</code>æ¥è®©å®ƒéšç€è¿™ä¸ªè·¯å¾„ä»¥ç›¸åŒçš„é€Ÿåº¦ç»˜åˆ¶ï¼Œå°±å¯ä»¥è¾¾åˆ°å®Œç¾çš„é”™è§‰æ•ˆæœï¼š</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="bp">CAKeyframeAnimation</span> <span class="o">*</span><span class="n">penAnimation</span> <span class="o">=</span> <span class="p">[</span><span class="bp">CAKeyframeAnimation</span> <span class="nl">animationWithKeyPath</span><span class="p">:</span><span class="s">@&quot;position&quot;</span><span class="p">];</span>
</span><span class='line'><span class="n">penAnimation</span><span class="p">.</span><span class="n">duration</span> <span class="o">=</span> <span class="mf">10.0</span><span class="p">;</span>
</span><span class='line'><span class="n">penAnimation</span><span class="p">.</span><span class="n">path</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="n">pathLayer</span><span class="p">.</span><span class="n">path</span><span class="p">;</span>
</span><span class='line'><span class="n">penAnimation</span><span class="p">.</span><span class="n">calculationMode</span> <span class="o">=</span> <span class="n">kCAAnimationPaced</span><span class="p">;</span>
</span><span class='line'><span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">penLayer</span> <span class="nl">addAnimation</span><span class="p">:</span><span class="n">penAnimation</span> <span class="nl">forKey</span><span class="p">:</span><span class="s">@&quot;penAnimation&quot;</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<p><a href="http://oleb.net/media/AnimatedPathsHausVomNikolaus.mp4">ç»˜åˆ¶æ™®é€šè·¯å¾„æ•ˆæœè§†é¢‘</a></p>

<p><a href="http://oleb.net/media/AnimatedPathsHausVomNikolaus.mp4">ä¸‹è½½åœ°å€</a></p>

<p>è¿™ä¸ªå¯¹æ–‡æœ¬ä¸€æ ·æœ‰æ•ˆï¼›æˆ‘ä»¬åªéœ€è¦æŠŠå­—ç¬¦è½¬åŒ–æˆ<code>CGPath</code>ã€‚<code>Core Text</code>æä¾›äº†é‚£æ ·çš„åŠŸèƒ½çš„å‡½æ•°ï¼Œ<a href="http://developer.apple.com/library/ios/documentation/Carbon/Reference/CTFontRef/Reference/reference.html#//apple_ref/c/func/CTFontCreatePathForGlyph">CTFontCreatePathForGlyph( )</a>ã€‚ä¸ºäº†ä½¿ç”¨å®ƒï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªå¸¦å±æ€§çš„å­—ç¬¦ä¸²ç”¨æˆ‘ä»¬æƒ³è¦æ¸²æŸ“çš„æ–‡æœ¬ï¼Œå…ˆæŠŠå®ƒä»¬åˆ†å‰²æˆè¡Œåœ¨åˆ†å‰²æˆä¸€ä¸ªä¸ªå­—ç¬¦ã€‚åœ¨æŠŠæ‰€æœ‰çš„å­—ç¬¦è½¬æ¢æˆè·¯å¾„åï¼Œæˆ‘ä»¬ä»¥å­è·¯å¾„æ–¹å¼æŠŠå®ƒæ·»åŠ åˆ°ä¸€ä¸ªå•ä¸ªçš„<code>CGPath</code>è·¯å¾„ä¸­ã€‚æ›´å¤šç»†èŠ‚å¯ä»¥æŸ¥çœ‹<a href="http://www.codeproject.com/script/Membership/View.aspx?mid=2887692">Ohmu</a>å†™çš„<a href="http://www.codeproject.com/KB/iPhone/Glyph.aspx">Low-level text rendering</a>è¿™ç¯‡æ–‡ç« ã€‚ç»“æœçœ‹ä»¥æ¥éå¸¸çš„ç‚«é…·ï¼š</p>

<p><a href="http://oleb.net/media/AnimatedPathsHelloWorld.mp4">ç»˜åˆ¶æ–‡å­—è·¯å¾„æ•ˆæœè§†é¢‘</a></p>

<p><a href="http://oleb.net/media/AnimatedPathsHelloWorld.mp4">ä¸‹è½½åœ°å€</a></p>

<p>ä»Githubä¸Šè·å¾—<a href="http://github.com/ole/Animated-Paths">iPadç‰ˆçš„æ ·å“å·¥ç¨‹</a></p>

<h1>ä½ å°†å­¦åˆ°çš„çŸ¥è¯†ç‚¹</h1>

<ul>
<li>ä½¿ç”¨<code>CAShapeLayer</code>çš„<code>strokeStart</code>å’Œ<code>strokeEnd</code>æ¥å®ç°è·¯å¾„åŠ¨ç”»,æ¯”è¾ƒé«˜çº§å¤æ‚çš„æ•ˆæœåƒgoogleçš„ä¸‹æ‹‰åˆ·æ–°è½¬åœˆå°±å¯ä»¥ä»è¿™é‡Œå¼•ç”³å»å®ç°ã€‚</li>
<li><code>CABasicAnimation</code>å’Œ<code>CABasicAnimation</code>ä½¿ç”¨</li>
<li>æ·±å…¥ç†è§£<code>CAShapeLayer</code>å’Œ<code>CALayer</code></li>
<li>é€šè¿‡æ–‡æœ¬åˆ›å»ºè·¯å¾„ï¼Œæ ¸å¿ƒå‡½æ•°<code>CTFontCreatePathForGlyph()</code></li>
</ul>


<h1>è¡¥å……è¯´æ˜</h1>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="bp">CAShapeLayer</span> <span class="o">*</span><span class="n">pathLayer</span> <span class="o">=</span> <span class="p">[</span><span class="bp">CAShapeLayer</span> <span class="n">layer</span><span class="p">];</span>
</span><span class='line'><span class="n">pathLayer</span><span class="p">.</span><span class="n">frame</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="n">animationLayer</span><span class="p">.</span><span class="n">bounds</span><span class="p">;</span>
</span><span class='line'><span class="n">pathLayer</span><span class="p">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="n">pathRect</span><span class="p">;</span>
</span><span class='line'><span class="n">pathLayer</span><span class="p">.</span><span class="n">geometryFlipped</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span>
</span><span class='line'><span class="n">pathLayer</span><span class="p">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="p">.</span><span class="bp">CGPath</span><span class="p">;</span>
</span><span class='line'><span class="n">pathLayer</span><span class="p">.</span><span class="n">strokeColor</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">UIColor</span> <span class="n">blackColor</span><span class="p">]</span> <span class="bp">CGColor</span><span class="p">];</span>
</span><span class='line'><span class="n">pathLayer</span><span class="p">.</span><span class="n">fillColor</span> <span class="o">=</span> <span class="nb">nil</span><span class="p">;</span>
</span><span class='line'><span class="n">pathLayer</span><span class="p">.</span><span class="n">lineWidth</span> <span class="o">=</span> <span class="mf">10.0f</span><span class="p">;</span>
</span><span class='line'><span class="n">pathLayer</span><span class="p">.</span><span class="n">lineJoin</span> <span class="o">=</span> <span class="n">kCALineJoinBevel</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">animationLayer</span> <span class="nl">addSublayer</span><span class="p">:</span><span class="n">pathLayer</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<p>æœ‰ä¸€ç‚¹éå¸¸é‡è¦ï¼ŒCALayeråœ¨iOSç³»ç»Ÿä¸­ç›¸å¯¹åæ ‡ç³»æ˜¯ä»¥å±å¹•å·¦ä¸Š<code>top-left</code>ä¸ºåæ ‡åŸç‚¹çš„ï¼Œåœ¨Mac OS Xä¸Šä»¥åä¸‹<code>bottom-left</code>ä¸ºåæ ‡åŸç‚¹,ä½†æ˜¯å¯ä»¥é€šè¿‡<code>CALayer</code>çš„æ¥å£<code>geometryFlipped</code>å‚ç›´ç¿»è½¬åæ ‡ç³»ï¼Œè¿™ä¸ªå€¼é»˜è®¤æ˜¯<code>NO</code>ï¼Œè®¾ç½®æˆ<code>YES</code>å°±å¯ä»¥æŠŠåæ ‡ç³»è½¬æ¢æˆå·¦ä¸‹<code>bottom-left</code>äº†ï¼Œè¿™é‡Œä½œè€…ä½¿ç”¨çš„å·¦ä¸‹<code>bottom-left</code>çš„åæ ‡ç³»ã€‚</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="k">@property</span><span class="p">(</span><span class="k">getter</span><span class="o">=</span><span class="n">isGeometryFlipped</span><span class="p">)</span> <span class="kt">BOOL</span> <span class="n">geometryFlipped</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>å…³äºè¿™ä¸ªå±æ€§ä½¿ç”¨æ—¶éœ€è¦ç‰¹åˆ«æ³¨æ„</p>

<ol>
<li>ç¿»è½¬ä¼šåŒæ—¶ä½œç”¨äºå®ƒçš„å­å›¾å±‚</li>
<li>å³ä½¿è¿™ä¸ªå±æ€§è®¾ç½®æˆ<code>YES</code>,å›¾ç‰‡çš„<code>orientation</code>ä»ç„¶æ˜¯ä¸å˜çš„ï¼ˆä¹Ÿå°±æ˜¯è¯´å½“è®¾ç½®<code>flipped=YES</code>å’Œ<code>flipped=NO</code>æ—¶ä¸€ä¸ª<code>CGImageRef</code>å‚¨å­˜åœ¨<code>contents</code>æ¥å£ä¸­çš„å†…å®¹å°†ä¼šæ˜¾ç¤ºä¸€è‡´ï¼Œèµ‹å€¼å¹¶ä¸ä¼šçœŸæ­£å˜æ¢åº•å±‚çš„å›¾å±‚ï¼‰</li>
</ol>


<h3>pathLayeråŠ¨ç”»å®ç°åŸç†</h3>

<ol>
<li>å…ˆåˆ›å»ºä¸€ä¸ªåŠ¨ç”»ç”¨çš„å›¾å±‚<code>animationLayer</code>ç±»å‹<code>CALayer</code>ï¼Œç”¨æ¥å……å½“åŠ¨ç”»çš„ç”»å¸ƒã€‚</li>
<li>åˆ›å»ºçœŸæ­£çš„è·¯å¾„å›¾å±‚<code>pathLayer</code>ç±»å‹ä¸º<code>CAShapeLayer</code>,è®©å®ƒçš„åæ ‡ç³»å‚ç›´ç¿»è½¬ï¼Œå¹¶ä¸”è®©å›¾å±‚å®½é«˜åŒæ—¶å‘å†…æ”¶ç¼©100ä¸ªç‚¹,é€šè¿‡<code>CGRectInset(CGRect rect, CGFloat dx, CGFloat dy)</code>å®ç°</li>
<li>æŠŠ<code>pathLayer</code>æ·»åŠ åˆ°<code>animationLayer</code>çš„å­å›¾å±‚ä¸­å»</li>
<li>åˆ›å»ºä¸€ä¸ªé“…ç¬”å›¾å±‚<code>penLayer</code>ç±»å‹ä¸º<code>CALayer</code>,æŠŠå®ƒæ·»åŠ åˆ°<code>pathLayer</code>å»</li>
<li>å¯¹<code>pathLayer</code>æ·»åŠ <code>CABasicAnimation</code>åŠ¨ç”»ï¼ŒåŠ¨ç”»å±æ€§ä¸º<code>strokeEnd</code></li>
<li>å¯¹<code>penLayer</code>æ·»åŠ <code>CAKeyframeAnimation</code>åŠ¨ç”»ï¼ŒåŠ¨ç”»å±æ€§ä¸º<code>position</code></li>
</ol>


<h3>textLayeråŠ¨ç”»å®ç°åŸç†</h3>

<ol>
<li>å…ˆåˆ›å»ºä¸€ä¸ªåŠ¨ç”»ç”¨çš„å›¾å±‚<code>animationLayer</code>ç±»å‹<code>CALayer</code>ï¼Œç”¨æ¥å……å½“åŠ¨ç”»çš„ç”»å¸ƒ</li>
<li>Create path from text,See:<a href="http://www.codeproject.com/KB/iPhone/Glyph.aspx">http://www.codeproject.com/KB/iPhone/Glyph.aspx</a>ï¼Œæœ€ç»ˆä¿å­˜åˆ°ä¸€ä¸ªç±»å‹ä¸º<code>CGMutablePathRef</code>çš„letterä¸­</li>
<li>é€šè¿‡letteræ¥åˆ›å»ºæ–‡å­—<code>UIBezierPath</code>ç±»å‹çš„<code>path</code></li>
<li>é€šè¿‡pathå†åˆ›å»º<code>CAShapeLayer</code>pathLayer,å¹¶ä¸”æŠŠpathLayeræ·»åŠ åˆ°<code>animationLayer</code>ä¸­å»</li>
<li>åˆ›å»ºä¸€ä¸ªé“…ç¬”å›¾å±‚<code>penLayer</code>ç±»å‹ä¸º<code>CALayer</code>,æŠŠå®ƒæ·»åŠ åˆ°<code>pathLayer</code>å»</li>
<li>å¯¹<code>pathLayer</code>æ·»åŠ <code>CABasicAnimation</code>åŠ¨ç”»ï¼ŒåŠ¨ç”»å±æ€§ä¸º<code>strokeEnd</code></li>
<li>å¯¹<code>penLayer</code>æ·»åŠ <code>CAKeyframeAnimation</code>åŠ¨ç”»ï¼ŒåŠ¨ç”»å±æ€§ä¸º<code>position</code></li>
</ol>


<h3>ä¿®å¤ä¸€å¤„bug</h3>

<p>é‡å¤ç‚¹å‡»<code>UISegmentedControl</code>å¯¼è‡´é“…ç¬”æ¶ˆå¤±ï¼Œè¿™æ˜¯è®¾ç½®äº†<code>penAnimation.delegate = self;</code>åœ¨ä»£ç†æ–¹æ³•é‡Œé¢æ²¡æœ‰åˆ¤æ–­ç»“æŸç›´æ¥å°†è®¾ç½®<code>self.penLayer.hidden = YES</code>ï¼Œå¯¼è‡´è¿ç»­åˆ‡æ¢æ—¶é“…ç¬”ä¸è§äº†ï¼Œè¦ä¿®å¤è¿™ä¸ªbugåªéœ€åŠ ä¸€ä¸ªåˆ¤æ–­<code>   if (flag)   self.penLayer.hidden = YES;
</code>å³å¯,è¿™æ ·çš„æ„æ€æ˜¯åªæœ‰å½“åŠ¨ç”»å®Œæˆæ—¶æ‰è®¾ç½®<code>self.penLayer.hidden</code>çš„å€¼ï¼Œå¥½äº†ç°åœ¨å·²ç»éå¸¸å®Œç¾äº†ï¼Œå¿«å»åŠ¨æ‰‹è‡ªå·±è¯•è¯•å§ï¼ğŸº</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOSä¸­çš„è§¦æ‘¸äº‹ä»¶å’Œæ‰‹åŠ¿å¤„ç†]]></title>
    <link href="http://wangruofeng.github.io/blog/2016/01/13/ioszhong-de-hong-mo-shi-jian-he-shou-shi-chu-li/"/>
    <updated>2016-01-13T04:34:00+08:00</updated>
    <id>http://wangruofeng.github.io/blog/2016/01/13/ioszhong-de-hong-mo-shi-jian-he-shou-shi-chu-li</id>
    <content type="html"><![CDATA[<h3>iOSè§¦æ‘¸äº‹ä»¶åˆ†ç±»</h3>

<ul>
<li>è§¦æ‘¸äº‹ä»¶</li>
<li>åŠ é€Ÿäº‹ä»¶</li>
<li>è¿œç¨‹äº‹ä»¶</li>
</ul>


<h3>è°èƒ½å¤„ç†è§¦æ‘¸äº‹ä»¶?</h3>

<p><strong>å“åº”è€…å¯¹è±¡</strong></p>

<p>åœ¨iOSä¸­ä¸æ˜¯ä»»ä½•å¯¹è±¡éƒ½èƒ½å¤„ç†äº‹ä»¶,åªæœ‰ç»§æ‰¿äº†UIResponderçš„å¯¹è±¡æ‰èƒ½æ¥æ”¶å¹¶å¤„ç†äº‹ä»¶.æˆ‘ä»¬ç§°ä¹‹ä¸º<strong>å“åº”è€…å¯¹è±¡</strong>.</p>

<p><code>UIApplication</code>,<code>UIViewController</code>,<code>UIView</code>éƒ½ç»§æ‰¿è‡ª<code>UIResponder</code>,å› æ­¤å®ƒä»¬éƒ½æ˜¯å“åº”è€…å¯¹è±¡,éƒ½èƒ½å¤Ÿæ¥æ”¶å¹¶å¤„ç†äº‹ä»¶.</p>

<h3>UIResponder</h3>

<p>UIResponderå†…éƒ¨æä¾›äº†æ–¹æ³•æ¥å¤„ç†äº‹ä»¶</p>

<ol>
<li><p>è§¦æ‘¸äº‹ä»¶</p>

<p> ä¸€æ¬¡å®Œæˆçš„è§¦æ‘¸è¿‡ç¨‹,ä¼šç»å†3ä¸ªçŠ¶æ€;
 UIViewçš„è§¦æ‘¸äº‹ä»¶å¤„ç†</p>

<p> 1.ä¸€æ ¹æˆ–å¤šæ ¹æ‰‹æŒ‡å¼€å§‹è§¦æ‘¸view,ç³»ç»Ÿä¼šè‡ªåŠ¨è°ƒç”¨viewä¸‹é¢çš„æ–¹æ³•:</p>

<pre><code> - (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event;  //è§¦æ‘¸å¼€å§‹
</code></pre>

 2.ä¸€æ ¹æˆ–è€…å¤šæ ¹æ‰‹æŒ‡åœ¨viewä¸Šç§»åŠ¨ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è°ƒç”¨viewä¸‹é¢çš„æ–¹æ³•ï¼ˆéšç€æ‰‹æŒ‡çš„ç§»åŠ¨ï¼Œä¼šæŒç»­è°ƒç”¨è¯¥æ–¹æ³•ï¼‰

<pre><code> - (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event;  //è§¦æ‘¸ç§»åŠ¨
</code></pre>

 3.ä¸€æ ¹æˆ–è€…å¤šæ ¹æ‰‹æŒ‡ç¦»å¼€viewï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è°ƒç”¨viewä¸‹é¢çš„æ–¹æ³•

<pre><code> - (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event;  //è§¦æ‘¸ç»“æŸ
</code></pre>

 4.è§¦æ‘¸ç»“æŸå‰ï¼ŒæŸä¸ªç³»ç»Ÿäº‹ä»¶ï¼ˆä¾‹å¦‚ç”µè¯å‘¼å…¥ ï¼‰ä¼šæ‰“æ–­è§¦æ‘¸è¿‡ç¨‹ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è°ƒç”¨viewä¸‹é¢çš„æ–¹æ³•

<pre><code> - (void)touchesCancelled:(NSSet *)touches withEvent:(UIEvent *)event; //è§¦æ‘¸å–æ¶ˆ(å¯èƒ½ä¼šç»å†)
</code></pre>

 4ä¸ªè§¦æ‘¸äº‹ä»¶çš„å¤„ç†æ–¹æ³•ä¸­ï¼Œéƒ½æœ‰ NSSet <em>touches å’Œ UIEvent </em>event ä¸¤ä¸ªå‚æ•°:

<ul>
<li>ä¸€æ¬¡å®Œæ•´çš„è§¦æ‘¸è¿‡ç¨‹ï¼Œåªä¼šäº§ç”Ÿä¸€ä¸ªäº‹ä»¶å¯¹è±¡ï¼Œ4ä¸ªè§¦æ‘¸æ–¹æ³•éƒ½æ˜¯åŒä¸€ä¸ªeventå‚æ•°</li>
<li>å¦‚æœä¸¤æ ¹æ‰‹æŒ‡åŒæ—¶è§¦æ‘¸ä¸€ä¸ªviewï¼Œé‚£ä¹ˆviewåªä¼šè°ƒç”¨ä¸€æ¬¡ touchesBegan:withEvent: æ–¹æ³•ï¼Œtoucheså‚æ•°ä¸­è£…ç€ä¸¤ä¸ªUITouchå¯¹è±¡ï¼›</li>
<li>å¦‚æœè¿™ä¸¤æ ¹æ‰‹æŒ‡ä¸€å‰ä¸€ååˆ†å¼€è§¦æ‘¸åŒä¸€ä¸ªviewï¼Œé‚£ä¹ˆviewä¼šåˆ†åˆ«è°ƒç”¨ä¸¤æ¬¡ touchesBegan:withEvent:æ–¹æ³•ï¼Œ å¹¶ä¸”æ¯æ¬¡è°ƒç”¨æ—¶çš„toucheså‚æ•°åªåŒ…å«ä¸€ä¸ªUITouchå¯¹è±¡ï¼›</li>
<li>æ ¹æ®touchesä¸­UITouchä¸ªæ•°å¯ä»¥åˆ¤æ–­å‡ºä½¿å•ç‚¹è§¦æ‘¸è¿˜æ˜¯å¤šç‚¹è§¦æ‘¸</li>
</ul>


<p> æç¤ºï¼štouchesä¸­å­˜æ”¾çš„éƒ½æ˜¯UITouchå¯¹è±¡ã€‚</p></li>
<li><p>åŠ é€Ÿè®¡äº‹ä»¶</p>

<pre><code> - (void)motionBegan:(UIEventSubtype)motion withEvent:(UIEvent *)event;
 - (void)motionEnded:(UIEventSubtype)motion withEvent:(UIEvent *)event;
 - (void)motionCancelled:(UIEventSubtype)motion withEvent:(UIEvent *)event;
</code></pre></li>
<li><p>è¿œç¨‹æ§åˆ¶äº‹ä»¶</p>

<pre><code> - (void)remoteControlReceivedWithEvent:(UIEvent *)event;
</code></pre></li>
</ol>


<h3>UITouch</h3>

<p>å½“ç”¨æˆ·ç”¨ä¸€æ ¹æ‰‹æŒ‡è§¦æ‘¸å±å¹•æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªä¸æ‰‹æŒ‡ç›¸å…³è”çš„UITouchå¯¹è±¡ï¼›ä¸€æ ¹æ‰‹æŒ‡å¯¹åº”ä¸€ä¸ªUITouchå¯¹è±¡
UITouchçš„ä½œç”¨:</p>

<ul>
<li>ä¿å­˜è·Ÿæ‰‹æŒ‡ç›¸å…³çš„ä¿¡æ¯ï¼Œæ¯”å¦‚è§¦æ‘¸çš„ä½ç½®ã€æ—¶é—´ã€é˜¶æ®µï¼›</li>
<li>å½“æ‰‹æŒ‡ç§»åŠ¨æ—¶ï¼Œç³»ç»Ÿä¼šæ›´æ–°åŒä¸€ä¸ªUITouchå¯¹è±¡ï¼Œä½¿ä¹‹èƒ½å¤Ÿä¸€ç›´ä¿å­˜è¯¥æ‰‹æŒ‡çš„è§¦æ‘¸ä½ç½®ï¼›</li>
<li>å½“æ‰‹æŒ‡ç¦»å¼€å±å¹•æ—¶ï¼Œç³»ç»Ÿä¼šé”€æ¯ç›¸åº”çš„UITouchå¯¹è±¡ã€‚</li>
</ul>


<p>æç¤ºï¼šiPhoneå¼€å‘ä¸­ï¼Œè¦é¿å…ä½¿ç”¨åŒå‡»äº‹ä»¶ã€‚</p>

<p>UITouchçš„å±æ€§:
è§¦æ‘¸äº§ç”Ÿæ—¶æ‰€å¤„çš„çª—å£:</p>

<pre><code>@property(nonatomic,readonly,retain) UIWindow *window;
</code></pre>

<p>è§¦æ‘¸äº§ç”Ÿæ—¶æ‰€å¤„çš„è§†å›¾</p>

<pre><code> @property(nonatomic,readonly,retain) UIView *view;
</code></pre>

<p>çŸ­æ—¶é—´å†…ç‚¹æŒ‰å±å¹•çš„æ¬¡æ•°ï¼Œå¯ä»¥æ ¹æ®tapCountåˆ¤æ–­å•å‡»ã€åŒå‡»æˆ–æ›´å¤šåœ°ç‚¹å‡»</p>

<pre><code> @property(nonatomic,readonly) NSUInteger tapCount;
</code></pre>

<p>è®°å½•äº†è§¦æ‘¸äº‹ä»¶äº§ç”Ÿæˆ–å˜åŒ–æ—¶çš„æ—¶é—´ï¼Œå•ä½æ˜¯ç§’</p>

<pre><code> @property(nonatomic,readonly) NSTimeInterval timestamp;
</code></pre>

<p>å½“å‰è§¦æ‘¸äº‹ä»¶æ‰€å¤„çš„çŠ¶æ€</p>

<pre><code>@property(nonatomic,readonly) UITouchPhase phase;
/*
UITouchPhaseæ˜¯ä¸€ä¸ªæšä¸¾ç±»å‹ï¼ŒåŒ…å«ï¼š
UITouchPhaseBeganï¼ˆè§¦æ‘¸å¼€å§‹ï¼‰
UITouchPhaseMovedï¼ˆæ¥è§¦ç‚¹ç§»åŠ¨ï¼‰
UITouchPhaseStationaryï¼ˆæ¥è§¦ç‚¹æ— ç§»åŠ¨ï¼‰
UITouchPhaseEndedï¼ˆè§¦æ‘¸ç»“æŸï¼‰
UITouchPhaseCancelledï¼ˆè§¦æ‘¸å–æ¶ˆï¼‰*/
</code></pre>

<p>UITouchçš„æ–¹æ³•ï¼š</p>

<pre><code>- (CGPoint)locationInView:(UIView *)view;
</code></pre>

<p>1.è¿”å›å€¼è¡¨ç¤ºè§¦æ‘¸åœ¨viewä¸Šçš„ä½ç½®ï¼›</p>

<p>2.è¿™é‡Œè¿”å›çš„ä½ç½®æ˜¯é’ˆå¯¹viewåæ ‡ç³»çš„,ï¼ˆä»¥viewçš„å·¦ä¸Šè§’ä¸ºåŸç‚¹ï¼ˆ0ï¼Œ0ï¼‰ï¼‰ï¼›</p>

<p>3.è°ƒç”¨æ—¶ä¼ å…¥çš„viewå‚æ•°ä¸ºnil çš„è¯ï¼Œè¿”å›çš„æ˜¯è§¦æ‘¸ç‚¹åœ¨UIWindowçš„ä½ç½®ã€‚</p>

<pre><code>- (CGPoint)previousLocationInView:(UIView *)view;
</code></pre>

<p>è¯¥æ–¹æ³•è®°å½•äº†å‰ä¸€ä¸ªè§¦æ‘¸ç‚¹çš„ä½ç½®ï¼›</p>

<h3>UIEvent</h3>

<blockquote><p>æ¯äº§ç”Ÿä¸€ä¸ªäº‹ä»¶ï¼Œå°±ä¼šäº§ç”Ÿä¸€ä¸ªUIEventå¯¹è±¡ï¼›</p>

<p>UIEvent:ç§°ä¸ºäº‹ä»¶å¯¹è±¡ï¼Œè®°å½•äº‹ä»¶äº§ç”Ÿçš„æ—¶åˆ»å’Œç±»å‹ã€‚</p></blockquote>

<p>å¸¸è§å±æ€§ï¼š
1.äº‹ä»¶ç±»å‹</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="k">@property</span><span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span><span class="k">readonly</span><span class="p">)</span> <span class="n">UIEventType</span>  <span class="n">type</span><span class="p">;</span>
</span><span class='line'><span class="k">@property</span><span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span><span class="k">readonly</span><span class="p">)</span> <span class="n">UIEventSubtype</span>  <span class="n">subtype</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">typedef</span>
</span><span class='line'><span class="nf">NS_ENUM</span><span class="p">(</span><span class="bp">NSInteger</span><span class="p">,</span> <span class="n">UIEventType</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">UIEventTypeTouches</span><span class="p">,</span>
</span><span class='line'>    <span class="n">UIEventTypeMotion</span><span class="p">,</span>
</span><span class='line'>    <span class="n">UIEventTypeRemoteControl</span><span class="p">,</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'><span class="k">typedef</span>
</span><span class='line'><span class="nf">NS_ENUM</span><span class="p">(</span><span class="bp">NSInteger</span><span class="p">,</span> <span class="n">UIEventSubtype</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// available in iPhone OS 3.0</span>
</span><span class='line'>    <span class="n">UIEventSubtypeNone</span>                              <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span class='line'>    <span class="c1">// for UIEventTypeMotion, available in iPhone OS 3.0</span>
</span><span class='line'>    <span class="n">UIEventSubtypeMotionShake</span>                       <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span class='line'>    <span class="c1">// for UIEventTypeRemoteControl, available in iOS 4.0</span>
</span><span class='line'>    <span class="n">UIEventSubtypeRemoteControlPlay</span>                 <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
</span><span class='line'>    <span class="n">UIEventSubtypeRemoteControlPause</span>                <span class="o">=</span> <span class="mi">101</span><span class="p">,</span>
</span><span class='line'>    <span class="n">UIEventSubtypeRemoteControlStop</span>                 <span class="o">=</span> <span class="mi">102</span><span class="p">,</span>
</span><span class='line'>    <span class="n">UIEventSubtypeRemoteControlTogglePlayPause</span>      <span class="o">=</span> <span class="mi">103</span><span class="p">,</span>
</span><span class='line'>    <span class="n">UIEventSubtypeRemoteControlNextTrack</span>            <span class="o">=</span> <span class="mi">104</span><span class="p">,</span>
</span><span class='line'>    <span class="n">UIEventSubtypeRemoteControlPreviousTrack</span>        <span class="o">=</span> <span class="mi">105</span><span class="p">,</span>
</span><span class='line'>    <span class="n">UIEventSubtypeRemoteControlBeginSeekingBackward</span> <span class="o">=</span> <span class="mi">106</span><span class="p">,</span>
</span><span class='line'>    <span class="n">UIEventSubtypeRemoteControlEndSeekingBackward</span>   <span class="o">=</span> <span class="mi">107</span><span class="p">,</span>
</span><span class='line'>    <span class="n">UIEventSubtypeRemoteControlBeginSeekingForward</span>  <span class="o">=</span> <span class="mi">108</span><span class="p">,</span>
</span><span class='line'>    <span class="n">UIEventSubtypeRemoteControlEndSeekingForward</span>    <span class="o">=</span> <span class="mi">109</span><span class="p">,</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>2.äº‹ä»¶äº§ç”Ÿçš„æ—¶é—´</p>

<pre><code>@property(nonatomic,readonly) NSTimeInterval  timestamp;
</code></pre>

<p> UIEventè¿˜æä¾›äº†ç›¸åº”çš„æ–¹æ³•å¯ä»¥è·å¾—åœ¨æŸä¸ªviewä¸Šé¢çš„è§¦æ‘¸å¯¹è±¡ï¼ˆUITouchï¼‰ã€‚</p>

<p> è§¦æ‘¸äº‹ä»¶çš„äº§ç”Ÿï¼š</p>

<ol>
<li><p>å‘ç”Ÿè§¦æ‘¸äº‹ä»¶åï¼Œç³»ç»Ÿä¼šå°†è¯¥äº‹ä»¶åŠ å…¥åˆ°ä¸€ä¸ªç”±UIApplicationç®¡ç†çš„äº‹ä»¶é˜Ÿåˆ—ä¸­ï¼›</p></li>
<li><p>UIApplicationä¼šä»äº‹ä»¶é˜Ÿåˆ—ä¸­å–å‡ºæœ€å‰é¢çš„äº‹ä»¶ï¼Œå¹¶å°†äº‹ä»¶åˆ†å‘ä¸‹å»ä»¥ä¾¿å¤„ç†ï¼Œé€šå¸¸ï¼Œå…ˆå‘é€äº‹ä»¶ç»™åº”ç”¨ç¨‹åºçš„ä¸»çª—å£ï¼ˆkeyWindowï¼‰ï¼›</p></li>
<li><p>ä¸»çª—å£ä¼šåœ¨è§†å›¾å±‚æ¬¡ç»“æ„ä¸­æ‰¾åˆ°ä¸€ä¸ªæœ€åˆé€‚çš„è§†å›¾æ§ä»¶æ¥å¤„ç†è§¦æ‘¸äº‹ä»¶ï¼Œè¿™ä¹Ÿæ˜¯æ•´ä¸ªäº‹ä»¶å¤„ç†è¿‡ç¨‹çš„ç¬¬ä¸€æ­¥ï¼›</p></li>
<li><p>æ‰¾åˆ°åˆé€‚çš„è§†å›¾æ§ä»¶åï¼Œå°±ä¼šè°ƒç”¨è§†å›¾æ§ä»¶çš„touchesæ–¹æ³•æ¥åšå…·ä½“çš„äº‹ä»¶å¤„ç†ã€‚</p></li>
</ol>


<p>è§¦æ‘¸äº‹ä»¶çš„ä¼ é€’ï¼š</p>

<blockquote><p>è§¦æ‘¸äº‹ä»¶çš„ä¼ é€’æ˜¯ä»çˆ¶æ§ä»¶ä¼ é€’åˆ°å­æ§ä»¶ï¼›</p>

<p>å¦‚æœçˆ¶æ§ä»¶ä¸èƒ½æ¥æ”¶è§¦æ‘¸äº‹ä»¶ï¼Œé‚£ä¹ˆå­æ§ä»¶å°±ä¸å¯èƒ½æ¥æ”¶åˆ°è§¦æ‘¸äº‹ä»¶ã€‚</p></blockquote>

<p><img src="http://ww4.sinaimg.cn/mw690/64124373gw1eznrp087anj205t07rdfx.jpg" alt="è§¦æ‘¸äº‹ä»¶" />
<img src="http://ww2.sinaimg.cn/mw690/64124373gw1eznrrf36ymj2097077dhc.jpg" alt="è§¦æ‘¸äº‹ä»¶2" /></p>

<p>UIViewä¸æ¥æ”¶è§¦æ‘¸äº‹ä»¶çš„ä¸‰ç§æƒ…å†µ:
ä¸æ¥å—ç”¨æˆ·äº¤äº’ ï¼š</p>

<ol>
<li><p>userInteractionEnable = NO;</p></li>
<li><p>éšè— ï¼šhidden = YES;</p></li>
<li><p>é€æ˜ï¼šalpha = 0.0 ~ 0.01</p></li>
</ol>


<p>æç¤ºï¼šUIImageViewçš„userInteractionEnableé»˜è®¤å°±æ˜¯NOï¼Œå› æ­¤UIImageViewä»¥åŠå®ƒçš„å­æ§ä»¶é»˜è®¤æ˜¯ä¸èƒ½æ¥æ”¶è§¦æ‘¸äº‹ä»¶çš„ã€‚</p>

<p>è§¦æ‘¸äº‹ä»¶å¤„ç†çš„è¯¦ç»†è¿‡ç¨‹ï¼š</p>

<ol>
<li><p>ç”¨æˆ·ç‚¹å‡»å±å¹•åäº§ç”Ÿçš„ä¸€ä¸ªè§¦æ‘¸äº‹ä»¶ï¼Œç»è¿‡ä¸€äº›åˆ—çš„ä¼ é€’è¿‡ç¨‹åï¼Œä¼šæ‰¾åˆ°æœ€åˆé€‚çš„è§†å›¾æ§ä»¶æ¥å¤„ç†è¿™ä¸ªäº‹ä»¶</p></li>
<li><p>æ‰¾åˆ°æœ€åˆé€‚çš„è§†å›¾æ§ä»¶åï¼Œå°±ä¼šè°ƒç”¨æ§ä»¶çš„touchesæ–¹æ³•æ¥ä½œå…·ä½“çš„äº‹ä»¶å¤„ç†</p>

<p> touchesBeganâ€¦</p>

<p> touchesMovedâ€¦</p>

<p> touchedEndedâ€¦</p></li>
</ol>


<p>è¿™äº›touchesæ–¹æ³•çš„é»˜è®¤åšæ³•æ˜¯å°†äº‹ä»¶é¡ºç€å“åº”è€…é“¾æ¡å‘ä¸Šä¼ é€’ï¼Œå°†äº‹ä»¶äº¤ç»™ä¸Šä¸€ä¸ªå“åº”è€…è¿›è¡Œå¤„ç†</p>

<p>å“åº”è€…é“¾çš„äº‹ä»¶ä¼ é€’è¿‡ç¨‹ï¼š</p>

<ol>
<li><p>å¦‚æœviewçš„æ§åˆ¶å™¨å­˜åœ¨ï¼Œå°±ä¼ é€’ç»™æ§åˆ¶å™¨ï¼›å¦‚æœæ§åˆ¶å™¨ä¸å­˜åœ¨ï¼Œåˆ™å°†å…¶ä¼ é€’ç»™å®ƒçš„çˆ¶è§†å›¾ï¼›</p></li>
<li><p>åœ¨è§†å›¾å±‚æ¬¡ç»“æ„æœ€é¡¶çº§çš„è§†å›¾ï¼Œå¦‚æœä¹Ÿä¸èƒ½å¤„ç†æ”¶åˆ°çš„äº‹ä»¶æˆ–æ¶ˆæ¯ï¼Œåˆ™å…¶å°†äº‹ä»¶æˆ–æ¶ˆæ¯ä¼ é€’ç»™windowå¯¹è±¡è¿›è¡Œå¤„ç†ã€‚</p></li>
<li><p>å¦‚æœwindowå¯¹è±¡ä¹Ÿä¸å¤„ç†ï¼Œåˆ™å…¶å°†äº‹ä»¶æˆ–æ¶ˆæ¯ä¼ é€’ç»™UIApplicationå¯¹è±¡ï¼›</p></li>
<li><p>å¦‚æœUIApplicationä¹Ÿä¸èƒ½å¤„ç†è¯¥äº‹ä»¶æˆ–æ¶ˆæ¯ï¼Œåˆ™å°†å…¶ä¸¢å¼ƒ</p></li>
</ol>


<h3>ç›‘å¬è§¦æ‘¸äº‹ä»¶çš„åšæ³•</h3>

<p>å¦‚æœæƒ³ç›‘å¬ä¸€ä¸ªviewä¸Šé¢çš„è§¦æ‘¸äº‹ä»¶ï¼Œä¹‹å‰çš„åšæ³•æ˜¯ï¼š</p>

<ol>
<li><p>è‡ªå®šä¹‰ä¸€ä¸ªviewï¼›</p></li>
<li><p>å®ç°viewçš„touchesæ–¹æ³•ï¼Œåœ¨æ–¹æ³•å†…éƒ¨å®ç°å…·ä½“å¤„ç†ä»£ç ã€‚</p>

<p> é€šè¿‡touchesæ–¹æ³•ç›‘å¬viewè§¦æ‘¸äº‹ä»¶ï¼Œæœ‰å¾ˆæ˜æ˜¾çš„å‡ ä¸ªç¼ºç‚¹ï¼š</p>

<ul>
<li><p>å¿…é¡»å¾—è‡ªå®šä¹‰viewï¼›</p></li>
<li><p>ç”±äºæ˜¯åœ¨viewå†…éƒ¨çš„touchesæ–¹æ³•ä¸­ç›‘å¬è§¦æ‘¸äº‹ä»¶ï¼Œå› æ­¤é»˜è®¤æƒ…å†µä¸‹ï¼Œæ— æ³•è®©å…¶ä»–å¤–ç•Œå¯¹è±¡ç›‘å¬viewçš„è§¦æ‘¸äº‹ä»¶ï¼›</p></li>
<li><p>ä¸å®¹æ˜“åŒºåˆ†ç”¨æˆ·çš„å…·ä½“æ‰‹åŠ¿è¡Œä¸ºã€‚</p></li>
</ul>
</li>
</ol>


<p>iOS 3.2ä¹‹åï¼Œè‹¹æœæ¨å‡ºäº†æ‰‹åŠ¿è¯†åˆ«åŠŸèƒ½ï¼ˆGesture Recognizerï¼‰,åœ¨è§¦æ‘¸äº‹ä»¶å¤„ç†æ–¹é¢ï¼Œå¤§å¤§ç®€åŒ–äº†å¼€å‘è€…çš„å¼€å‘éš¾åº¦ã€‚</p>

<h3>UIGestureRescognizer</h3>

<p>ä¸ºäº†å®Œæˆæ‰‹åŠ¿è¯†åˆ«ï¼Œå¿…é¡»å€ŸåŠ©äºæ‰‹åŠ¿è¯†åˆ«å™¨ï¼šUIGestureRecognizer ã€‚</p>

<p>åˆ©ç”¨UIGestureRecognizer,èƒ½è½»æ¾è¯†åˆ«ç”¨æˆ·åœ¨æŸä¸ªviewä¸Šé¢åšçš„ä¸€äº›å¸¸è§æ‰‹åŠ¿ã€‚</p>

<p>UIGestureRecognizeræ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®šä¹‰äº†æ‰€æœ‰çš„æ‰‹åŠ¿åŸºæœ¬è¡Œä¸ºï¼Œä½¿ç”¨å®ƒçš„å­ç±»æ‰èƒ½å¤„ç†å…·ä½“çš„æ‰‹åŠ¿</p>

<ul>
<li>UITapGestureRecognizer(æ•²å‡»)</li>
<li>UIPinchGestureRecognizer(æåˆï¼Œç”¨äºç¼©æ”¾)</li>
<li>UIPanGestureRecognizer(æ‹–æ‹½)</li>
<li>UISwipeGestureRecognizer(è½»æ‰«)</li>
<li>UIRotationGestureRecognizer(æ—‹è½¬)</li>
<li>UILongPressGestureRecognizer(é•¿æŒ‰)</li>
</ul>


<p>æ¯ä¸€ä¸ªæ‰‹åŠ¿è¯†åˆ«å™¨çš„ç”¨æ³•éƒ½å·®ä¸å¤šï¼Œæ¯”å¦‚UITapGestureRecognizerçš„ä½¿ç”¨æ­¥éª¤å¦‚ä¸‹:</p>

<ol>
<li><p>åˆ›å»ºæ‰‹åŠ¿è¯†åˆ«å™¨å¯¹è±¡ï¼›</p>

<p> UITapGestureRecognizer *tap = [[UITapGestureRecognizer alloc] init];</p></li>
<li><p>è®¾ç½®æ‰‹åŠ¿è¯†åˆ«å™¨å¯¹è±¡çš„å…·ä½“å±æ€§ï¼›</p>

<pre><code> // è¿ç»­æ•²å‡»2æ¬¡
 tap.numberOfTapsRequired = 2;
 // éœ€è¦2æ ¹æ‰‹æŒ‡ä¸€èµ·æ•²å‡»
 tap.numberOfTouchesRequired = 2;
</code></pre></li>
<li><p>æ·»åŠ æ‰‹åŠ¿è¯†åˆ«å™¨åˆ°å¯¹åº”çš„viewä¸Š</p>

<p> [self.iconView addGestureRecognizer:tap];</p></li>
<li><p>ç›‘å¬æ‰‹åŠ¿çš„è§¦å‘</p>

<p> [tap addTarget:self action:@selector(tapIconView:)];</p></li>
</ol>


<p>æ‰‹åŠ¿è¯†åˆ«çš„çŠ¶æ€</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="k">typedef</span> <span class="nf">NS_ENUM</span><span class="p">(</span><span class="bp">NSInteger</span><span class="p">,</span> <span class="n">UIGestureRecognizerState</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// æ²¡æœ‰è§¦æ‘¸äº‹ä»¶å‘ç”Ÿï¼Œæ‰€æœ‰æ‰‹åŠ¿è¯†åˆ«çš„é»˜è®¤çŠ¶æ€</span>
</span><span class='line'>    <span class="n">UIGestureRecognizerStatePossible</span><span class="p">,</span>
</span><span class='line'>    <span class="c1">// ä¸€ä¸ªæ‰‹åŠ¿å·²ç»å¼€å§‹ä½†å°šæœªæ”¹å˜æˆ–è€…å®Œæˆæ—¶</span>
</span><span class='line'>    <span class="n">UIGestureRecognizerStateBegan</span><span class="p">,</span>
</span><span class='line'>    <span class="c1">// æ‰‹åŠ¿çŠ¶æ€æ”¹å˜</span>
</span><span class='line'>    <span class="n">UIGestureRecognizerStateChanged</span><span class="p">,</span>
</span><span class='line'>    <span class="c1">// æ‰‹åŠ¿å®Œæˆ</span>
</span><span class='line'>    <span class="n">UIGestureRecognizerStateEnded</span><span class="p">,</span>
</span><span class='line'>    <span class="c1">// æ‰‹åŠ¿å–æ¶ˆï¼Œæ¢å¤è‡³PossibleçŠ¶æ€</span>
</span><span class='line'>    <span class="n">UIGestureRecognizerStateCancelled</span><span class="p">,</span>
</span><span class='line'>    <span class="c1">// æ‰‹åŠ¿å¤±è´¥ï¼Œæ¢å¤è‡³PossibleçŠ¶æ€</span>
</span><span class='line'>    <span class="n">UIGestureRecognizerStateFailed</span><span class="p">,</span>
</span><span class='line'>    <span class="c1">// è¯†åˆ«åˆ°æ‰‹åŠ¿è¯†åˆ«</span>
</span><span class='line'>    <span class="n">UIGestureRecognizerStateRecognized</span> <span class="o">=</span> <span class="n">UIGestureRecognizerStateEnded</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>å‚è€ƒèµ„æ–™ï¼š<a href="http://my.oschina.net/aofe/blog/268749">å‚²é£å‡Œå¯’çš„åšå®¢</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Blogç½‘ç«™å¤‡å¿˜å½•]]></title>
    <link href="http://wangruofeng.github.io/blog/2016/01/13/blogwang-zhan-bei-wang-lu/"/>
    <updated>2016-01-13T04:29:59+08:00</updated>
    <id>http://wangruofeng.github.io/blog/2016/01/13/blogwang-zhan-bei-wang-lu</id>
    <content type="html"><![CDATA[<blockquote><p>ç”¨äºæ”¶è—ä¸é”™çš„ä¸ªäººæˆ–è€…å…¬å¸Blogåœ°å€</p>

<p>å–œæ¬¢çš„åŒå­¦è¯·Starå’Œé—®é¢˜å»ºè®®è¯·pull me</p></blockquote>

<h2>å¹½å¹½ä¼ é€é—¨</h2>

<ul>
<li><a href="http://www.jianshu.com/p/e5353a1a752c">æˆ‘å¸¸å¸¸æµè§ˆçš„åšå®¢å’Œç½‘ç«™
</a> &ndash;<a href="http://www.jianshu.com/users/b82d2721ba07">å¶å­¤åŸ__</a></li>
<li><a href="http://www.cocoachina.com/ios/20150626/11348.html">11ä¸ªè¶…æ£’çš„iOSå¼€å‘å­¦ä¹ ç½‘ç«™</a></li>
<li><a href="http://blog.devtang.com/blog/2014/07/27/ios-levelup-tips/">iOSå¼€å‘å¦‚ä½•æé«˜</a></li>
<li><a href="https://github.com/tangqiaoboy/iOSBlogCN-">ä¸­æ–‡ iOS/Mac å¼€å‘åšå®¢åˆ—è¡¨</a>&ndash;å”å·§ç²¾å¿ƒæ•´ç†äº†å›½å†…40å¤šä½iOSå¼€å‘åšä¸»çš„åšå®¢åœ°å€åˆ—è¡¨</li>
</ul>


<h2>ç®€ä¹¦</h2>

<ul>
<li><a href="http://www.jianshu.com/users/b82d2721ba07/latest_articles">å¶å­¤åŸ___</a></li>
<li><a href="http://www.jianshu.com/users/39eeabac725a/latest_articles">MarkNote</a></li>
<li><a href="http://www.jianshu.com/users/384f80cdc57b/latest_articles">lp_é©¬å»ºæˆ</a></li>
<li><a href="http://www.jianshu.com/users/7ba5d9065301/latest_articles">seedante
</a></li>
<li><a href="http://www.jianshu.com/users/960f3b94323a/latest_articles">å¤§ç°ç°iOS</a></li>
<li><a href="http://www.jianshu.com/users/56475732c6e9/latest_articles">StrongX</a></li>
</ul>


<h2>å›½å†…ä¸ªäºº</h2>

<ul>
<li><a href="http://onevcat.com/?from=inf&amp;wvr=5&amp;loc=infblog">çŒ«ç¥onevcat</a></li>
<li><a href="http://blog.devtang.com/">å”å·§</a>&ndash;çŒ¿é¢˜åº“ä½œè€…</li>
<li><a href="http://blog.txx.im/?from=inf&amp;wvr=5&amp;loc=infblog">è™¾ç¥</a>&ndash;è¯è¯´ä½ ä»¬æ™“å¾—è™¾ç¥å¹´çºªå¤šå¤§ä¹ˆï¼Ÿåæ­£æˆ‘æ˜¯è§‰å¾—ç™½æ´»äº†ã€‚90åå¤ªå‰å®³äº†ã€‚</li>
<li><a href="http://blog.sunnyxx.com/2015/05/17/cell-height-calculation/">sunnyxx</a></li>
<li><a href="https://github.com/nixzhu/dev-blog">nixzhu</a>&ndash;æœ‰å‡ ç¯‡ç¿»è¯‘çš„æ–‡ç« è´¨é‡ä¸é”™</li>
<li><a href="http://beyondvincent.com">ç ´èˆ¹ä¹‹å®¶</a>&ndash;è¿™è®©æˆ‘æƒ³èµ·ï¼Œå–ä¸Šä¸€æ¯æœ—å§†é…’ğŸº</li>
<li><a href="http://macshuo.com/?page_id=93">MacTalk-æ± å»ºå¼ºçš„éšæƒ³å½•</a>&ndash;Macå¼€å‘å¤§ç‰›</li>
<li><a href="http://www.xuanyusong.com">é›¨æ¾MOMO</a>&ndash;ä¸“æ³¨ç§»åŠ¨äº’è”ç½‘ï¼Œä¸“æ³¨Unity3Dæ¸¸æˆå¼€å‘,å›½å†…æœ€æ—©å¼€å‘Unity3dçš„å¤§ç¥ä¹‹ä¸€</li>
</ul>


<h2>å›½å¤–ä¸ªäºº</h2>

<ul>
<li><a href="https://www.mikeash.com">mikeash</a>&ndash;ç™½å¤©é£è¡Œå‘˜ï¼Œæ™šä¸Šç¨‹åºå‘˜ ï¼š] just this guy, you know?</li>
<li><a href="https://www.shinobicontrols.com/blog">shinobicontrols</a>&ndash;iOS æœ€æ–° API ä»¥åŠæ–°åŠŸèƒ½ç”¨æ³•</li>
<li><a href="http://iosdevelopertips.com/user-interface/custom-visual-calendar-control-for-ios.html">iosdevelopertips</a>&ndash;æ•™ç¨‹é…åˆDemoè®©ä½ å­¦ä¹ æˆé•¿ç«‹ç«¿è§å½±</li>
<li><a href="http://iosdevweekly.com">iosdevweekly</a>&ndash;å¾ˆæ£’çš„ä¸ªäººæŠ€æœ¯åšå®¢ç½‘ï¼Œå·²å‘è¡¨230ç¯‡æ–‡ç« </li>
<li><a href="http://ios-goodies.com">ios-goodies</a>&ndash;iOS,UI,UX,Objective-c,Swift,Xcode</li>
<li><a href="http://nshipster.cn/authors/mattt-thompson/">mattt-thompson</a> &ndash; ä¸ç”¨è§£é‡Š</li>
<li><a href="http://subjc.com">subjc</a> &ndash;Subjective-C is a study of innovative iOS interfaces.</li>
<li><a href="http://www.thinkandbuild.it">thinkandbuild</a>&ndash;ã€ŠIntroduction To 3D Drawing in CoreAnimtionã€‹ä½œè€…</li>
<li><a href="http://robb.is/">robb.is</a>&ndash;ã€ŠHow to build a nice Hamburger transition in swiftã€‹ä½œè€…</li>
<li><a href="http://commandshift.co.uk">commandshift</a>&ndash;ä¸å¤šè¯´ï¼Œè´¨é‡æé«˜</li>
<li><a href="http://indieambitions.com/">indieambitions</a>&ndash;raywenderlichå¸¸é©»ä½œè€…ä¹‹ä¸€çš„blogï¼Œéå¸¸èµã€‚</li>
<li><a href="http://nvie.com">nvie</a>&ndash;å›½å¤–ä¸€ä¸ªå¤§ç¥çš„blogï¼Œè®²å¾—æ¯”è¾ƒæ‚ï¼Œgitï¼Œiosï¼Œpythonéƒ½æœ‰æ¶‰çŒï¼Œä½†æ˜¯æ¯ç¯‡éƒ½å¾ˆç²¾å½©ã€‚</li>
<li><a href="http://stuartkhall.com">stuartkhall</a>&ndash;å¾ˆå¤šå…³äºappä¸Šçº¿è¿è¥ä¹‹ç±»çš„blogï¼Œå€¼å¾—ä¸€çœ‹ã€‚</li>
<li><a href="http://blog.ittybittyapps.com">ittybittyapps</a>&ndash;ç¥å™¨Revealçš„ä½œè€…çš„blogã€‚</li>
<li><a href="http://adoptioncurve.net/">adoptioncurve</a>&ndash;æ›´æ–°æå¿«ï¼Œå½“æ—¶iOS8è¿˜æ²¡å‡ºå‡ ä¸ªå‘¨ï¼Œä½œè€…å°±å†™äº†ç¯‡sizeclassè§£æã€‚éå¸¸æ£’</li>
<li><a href="http://ciechanowski.me">ciechanowski</a>&ndash;å„ç§æ•°å­¦ä¸Šå‡ ä½•å˜åŒ–</li>
<li><a href="https://www.bignerdranch.com/blog/">bignerdranch</a></li>
<li><a href="http://www.cocoawithlove.com">cocoawithlove</a>&ndash;2008-2011çš„è€æ–‡ç« ï¼Œç°åœ¨æ²¡æ€ä¹ˆè·Ÿæ–°äº†</li>
<li><a href="http://blog.codinghorror.com/">codinghorror</a> &ndash;<a href="https://twitter.com/codinghorror">Jeff Atwood </a>ä¸»ç«™</li>
<li><a href="http://www.g8production.com/">g8production</a></li>
</ul>


<h2>å›¢ä½“blog</h2>

<ul>
<li><a href="http://blog.ibireme.com">ibireme</a>&ndash;æœ€è¿‘å¾ˆğŸ”¥çš„YYKitçš„ä½œè€…</li>
<li><a href="http://tech.glowing.com/cn/">GlowæŠ€æœ¯å›¢é˜Ÿ</a></li>
<li><a href="http://tech.meituan.com">ç¾å›¢ç‚¹è¯„æŠ€æœ¯å›¢é˜Ÿ</a></li>
</ul>


<h2>ä¼˜è´¨iOSå­¦ä¹ èµ„æº</h2>

<ul>
<li><a href="https://github.com">github</a>&ndash;è¿™ä¸ªä¸ç”¨æˆ‘è¯´å§</li>
<li><a href="http://stackoverflow.com">stackoverflow</a>&ndash;æœ€ä¸“ä¸šçš„é—®ç­”ç¤¾åŒº</li>
<li><a href="http://www.raywenderlich.com">raywenderlich</a>&ndash;iOSç•Œçš„ç™¾ç§‘å…¨ä¹¦</li>
<li><a href="http://nshipster.com">nshipster</a>&ndash;é‡Œé¢æ–‡ç« è´¨é‡éå¸¸çš„é«˜ï¼Œæœ€å–œæ¬¢çš„å‡ ä¸ªç½‘ç«™ä¹‹ä¸€<a href="https://github.com/AFNetworking/AFNetworking">AFNetworkting</a>çš„ä½œè€…<a href="http://nshipster.com/authors/mattt-thompson/">Mattt Thompson</a>&ndash;ç»å¸¸å‡ºæ²¡</li>
<li><a href="http://nshipster.cn">nshipsterä¸­å›½</a></li>
<li><a href="http://www.objc.io">objc.io</a>&ndash;è¿™ä¸ªä¹Ÿä¸ç”¨å¤šè¯´äº†ï¼ŒRaywenderlichæ˜¯ç™¾ç§‘å…¨ä¹¦çš„è¯ï¼Œè¿™ä¸ªå°±æ˜¯æ·±å…¥æ·±å…¥å†æ·±å…¥</li>
<li><a href="http://objcio.cn">objcä¸­å›½</a></li>
<li><a href="https://realm.io">realm.io</a>&ndash;ä¸€ä¸ªè·¨å¹³å°çš„ç§»åŠ¨æ•°æ®åº“å¼•æ“</li>
<li><a href="http://tutsplus.com/">tutsplus</a>&ndash;ä¹Ÿæ˜¯åŒ…ç½—ä¸‡è±¡çš„ä¸€ä¸ªç½‘ç«™ï¼Œæœ‰web ios uiï¼Œä¸æ¯”Raywenderliché€Šè‰²ã€‚</li>
<li><a href="https://maniacdev.com">maniacdev</a>&ndash;ç±»ä¼¼Raywenderlichï¼Œæ–‡ç« è´¨é‡é«˜ï¼Œè€Œä¸”æ¶µç›–é¢å¹¿</li>
</ul>


<h2>ä¸­æ–‡ç½‘ç«™</h2>

<ul>
<li><a href="http://www.cocoachina.com">cocoachina</a></li>
<li><a href="http://www.code4app.com">code4app</a></li>
<li><a href="http://www.tairan.com">æ³°ç„¶ç½‘</a> &ndash;æ¸¸æˆæ•™ç¨‹ä¸é”™çš„ç½‘ç«™</li>
<li><a href="http://blog.jobbole.com">ä¼¯ä¹åœ¨çº¿</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[__autoreleasingçš„ç†è§£]]></title>
    <link href="http://wangruofeng.github.io/blog/2016/01/13/autoreleasingde-li-jie/"/>
    <updated>2016-01-13T04:27:10+08:00</updated>
    <id>http://wangruofeng.github.io/blog/2016/01/13/autoreleasingde-li-jie</id>
    <content type="html"><![CDATA[<h3>__autoreleasing ä¿®é¥°ç¬¦</h3>

<p>å°†å¯¹è±¡èµ‹å€¼ç»™é™„æœ‰__autoreleasing ä¿®é¥°ç¬¦çš„å˜é‡ç­‰åŒäºARC æ— æ•ˆæ—¶è°ƒç”¨å¯¹è±¡çš„autoreleaseæ–¹æ³•ã€‚æˆ‘ä»¬é€šè¿‡ä»¥ä¸‹æºä»£ç æ¥çœ‹ä¸€ä¸‹</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="k">@autoreleasepool</span> <span class="p">{</span>
</span><span class='line'><span class="kt">id</span> <span class="k">__autoreleasing</span> <span class="n">obj</span>  <span class="o">=</span> <span class="p">[[</span><span class="bp">NSObject</span> <span class="n">alloc</span><span class="p">]</span> <span class="n">init</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>è¯¥æºä»£ç ä¸»è¦å°†NSObject ç±»å¯¹è±¡æ³¨å†Œåˆ°autoreleasepool ä¸­ï¼Œå¯ä½œå¦‚ä¸‹å˜æ¢ï¼š</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="cm">/* ç¼–è¯‘å™¨çš„æ¨¡æ‹Ÿä»£ç  */</span>
</span><span class='line'><span class="kt">id</span> <span class="n">pool</span> <span class="o">=</span> <span class="n">objc_autoreleasePoolPush</span><span class="p">();</span>
</span><span class='line'><span class="kt">id</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">objc_msgSend</span><span class="p">(</span><span class="bp">NSObject</span><span class="p">,</span> <span class="k">@selector</span><span class="p">(</span><span class="n">alloc</span><span class="p">));</span>
</span><span class='line'><span class="n">objc_msgSend</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="k">@selector</span><span class="p">(</span><span class="n">init</span><span class="p">));</span>
</span><span class='line'><span class="n">objc_autorelease</span><span class="p">(</span><span class="n">obj</span><span class="p">);</span>
</span><span class='line'><span class="n">objc_autoreleasePoolPop</span><span class="p">(</span><span class="n">pool</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>è¿™ä¸è‹¹æœçš„autorelease å®ç°ä¸­çš„è¯´æ˜ï¼ˆå‚è€ƒ1.2.7 èŠ‚ï¼‰å®Œå…¨ç›¸åŒã€‚è™½ç„¶ARC æœ‰æ•ˆå’Œæ— æ•ˆæ—¶ï¼Œå…¶åœ¨æºä»£ç ä¸Šçš„è¡¨ç°æœ‰æ‰€ä¸åŒï¼Œä½†autorelease çš„åŠŸèƒ½å®Œå…¨ä¸€æ ·ã€‚</p>

<p>åœ¨alloc/new/copy/mutableCopy æ–¹æ³•ç¾¤ä¹‹å¤–çš„æ–¹æ³•ä¸­ä½¿ç”¨æ³¨å†Œåˆ°autoreleasepool ä¸­çš„å¯¹è±¡ä¼šå¦‚ä½•å‘¢ï¼Ÿä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹NSMutableArray ç±»çš„array ç±»æ–¹æ³•ã€‚</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="k">@autoreleasepool</span> <span class="p">{</span>
</span><span class='line'><span class="kt">id</span> <span class="k">__autoreleasing</span> <span class="n">obj</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSMutableArray</span> <span class="n">array</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>è¿™ä¸å‰é¢çš„æºä»£ç æœ‰ä½•ä¸åŒå‘¢ï¼Ÿ</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="cm">/* ç¼–è¯‘å™¨çš„æ¨¡æ‹Ÿä»£ç  */</span>
</span><span class='line'><span class="kt">id</span> <span class="n">pool</span> <span class="o">=</span> <span class="n">objc_autoreleasePoolPush</span><span class="p">();</span>
</span><span class='line'><span class="kt">id</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">objc_msgSend</span><span class="p">(</span><span class="bp">NSMutableArray</span><span class="p">,</span> <span class="k">@selector</span><span class="p">(</span><span class="n">array</span><span class="p">));</span>
</span><span class='line'><span class="n">objc_retainAutoreleasedReturnValue</span><span class="p">(</span><span class="n">obj</span><span class="p">);</span>
</span><span class='line'><span class="n">objc_autorelease</span><span class="p">(</span><span class="n">obj</span><span class="p">);</span>
</span><span class='line'><span class="n">objc_autoreleasePoolPop</span><span class="p">(</span><span class="n">pool</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>è™½ç„¶æŒæœ‰å¯¹è±¡çš„æ–¹æ³•ä»alloc æ–¹æ³•å˜ä¸ºobjc_retainAutoreleasedReturnValue å‡½æ•°ï¼Œ ä½†æ³¨å†Œautoreleasepool çš„æ–¹æ³•æ²¡æœ‰æ”¹å˜ï¼Œä»æ˜¯objc_autorelease å‡½æ•°ã€‚</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[__attribute__]]></title>
    <link href="http://wangruofeng.github.io/blog/2016/01/13/attribute/"/>
    <updated>2016-01-13T04:10:33+08:00</updated>
    <id>http://wangruofeng.github.io/blog/2016/01/13/attribute</id>
    <content type="html"><![CDATA[<ul>
<li>è¯‘è‡ª Written by <a href="http://nshipster.com/authors/mattt-thompson/">Mattt Thompson</a> â€” January 14th, 2013</li>
<li>åŸæ–‡é“¾æ¥ï¼š<a href="http://nshipster.com/__attribute__/">http://nshipster.com/__attribute__/</a></li>
<li>è¯‘è€…<a href="https://twitter.com/oneruofeng">@oneruofeng</a></li>
</ul>


<p>é‡å¤å‘å¸ƒè¿™ä¸ªä¸»é¢˜å·²ç»è¯´æ˜äº†åŒç¼–è¯‘å™¨ä¿å­˜å¥åº·å…³ç³»çš„é‡è¦æ€§,åƒä»»ä½•è‰ç¨¿ä¸€æ ·ï¼Œä½œä¸ºä¸€ä¸ªå®è·µè€…çš„æ•ˆç‡å–å†³äºä»–ä»¬æ€æ ·å¯¹å¾…ä»–ä»¬çš„å·¥å…·ï¼Œä½ ç…§é¡¾å¥½å®ƒä»¬ï¼Œå®ƒä»¬åè¿‡æ¥ä¹Ÿä¼šå¯¹ä½ æœ‰å¥½å¤„ã€‚</p>

<p> <code>__attribute__</code>æ˜¯ä¸€ä¸ªç¼–è¯‘å™¨çš„æŒ‡ä»¤åœ¨å£°æ˜çš„æ—¶å€™æŒ‡æ˜äº†ä¸€äº›å‚æ•°ï¼Œè¿™äº›å‚æ•°å…è®¸æ›´å¤šçš„æ£€æŸ¥é”™è¯¯å’Œé«˜çº§çš„ä¼˜åŒ–ã€‚</p>

<p> è¯­æ³•å…³é”®å­—æ˜¯<code>__attribute__</code>ç´§è·Ÿ2å¥—åœ†æ‹¬å·ï¼ˆåŒåœ†æ‹¬å·è®©å‡ºç°çš„å®æ›´å®¹æ˜“è¾¨è®¤ï¼Œç‰¹åˆ«æ˜¯åœ¨æœ‰å¤šä¸ªå±æ€§çš„æ—¶å€™ï¼‰ã€‚åœ¨æ‹¬å·å†…éƒ¨æ˜¯ä¸€ä¸ªä»¥é€—å·åˆ†éš”çš„å±æ€§åˆ—è¡¨ï¼Œ<code>__attribute__</code>æŒ‡ä»¤è¢«æ”¾åœ¨å‡½æ•°ï¼Œå˜é‡å’Œç±»å‹å£°æ˜åé¢ã€‚</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'> <span class="c1">// Return the square of a number</span>
</span><span class='line'><span class="kt">int</span> <span class="nf">square</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="n">__attribute__</span><span class="p">((</span><span class="k">const</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Declare the availability of a particular API</span>
</span><span class='line'><span class="kt">void</span> <span class="nf">f</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span><span class='line'>  <span class="n">__attribute__</span><span class="p">((</span><span class="n">availability</span><span class="p">(</span><span class="n">macosx</span><span class="p">,</span><span class="n">introduced</span><span class="o">=</span><span class="mf">10.4</span><span class="p">,</span><span class="n">deprecated</span><span class="o">=</span><span class="mf">10.6</span><span class="p">)));</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Send printf-like message to stderr and exit</span>
</span><span class='line'><span class="k">extern</span> <span class="kt">void</span> <span class="nf">die</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">format</span><span class="p">,</span> <span class="p">...)</span>
</span><span class='line'>  <span class="n">__attribute__</span><span class="p">((</span><span class="n">noreturn</span><span class="p">,</span> <span class="n">format</span><span class="p">(</span><span class="n">printf</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)));</span>
</span></code></pre></td></tr></table></div></figure>


<p>å‡å¦‚è¿™ä¸ªè®©ä½ æƒ³èµ·ISO Cè¯­è¨€çš„ <code>#pragma</code>,ä½ å°±ä¸ä¼šæ„Ÿåˆ°å­¤å•äº†ã€‚</p>

<p>å®é™…ä¸Šï¼Œå½“<code>__attribute__</code>è¢«ç¬¬ä¸€æ¬¡å¼•å…¥åˆ°<code>GCC</code>ç¼–è¯‘å™¨æ—¶ï¼Œå®ƒé¢ä¸´ä¸€äº›é˜»åŠ›ï¼Œæœ‰äººå»ºè®®ä½¿ç”¨ä¸“ç”¨çš„<code>#pragma</code>å› ä¸ºç›¸åŒçš„ç›®çš„ã€‚</p>

<p>è¿™é‡Œï¼Œç„¶è€Œï¼Œæœ‰2ä¸ªéå¸¸å¥½çš„ç†ç”±ä¸ºä»€ä¹ˆ<code>__attribute__</code>è¢«æ·»åŠ è¿›æ¥</p>

<blockquote><ul>
<li>ä»ä¸€ä¸ªå®ä¸­äº§ç”Ÿ<code>#pragma</code>å‘½ä»¤å‡ ä¹æ˜¯ä¸èƒ½çš„ï¼ˆåœ¨C99 _Pragma é¢„ç®—ç¬¦ä»¥å‰ï¼‰ã€‚</li>
<li>è¿™é‡Œæ²¡äººçŸ¥é“ç›¸åŒçš„<code>#pragma</code>åœ¨å¦ä¸€ä¸ªç¼–è¯‘å™¨ä¸­å¯èƒ½çš„æ„æ€ã€‚</li>
</ul>
</blockquote>

<p> å¼•ç”¨<a href="http://gcc.gnu.org/onlinedocs/gcc/Function-Attributes.html">GCC Documentation for Function Attributes</a></p>

<blockquote><ul>
<li>è¿™é‡Œæœ‰2ä¸ªåŸå› è¢«åº”ç”¨åˆ°å‡ ä¹æ‰€æœ‰çš„åº”ç”¨æ¨èä½¿ç”¨<code>#pragma</code>,è¿™çŠ¯äº†ä¸€ä¸ªä½çº§é”™è¯¯å°±æ˜¯æŠŠ<code>#pragma</code>ä½¿ç”¨åˆ°ä»»ä½•åœ°æ–¹ã€‚</li>
</ul>
</blockquote>

<p> ç¡®å®ï¼Œå‡å¦‚ä½ åœ¨è‹¹æœçš„æ¡†æ¶ä¸­å’Œç‰›é€¼å·¥ç¨‹å¸ˆçš„å¼€æºé¡¹ç›®ä¸­çš„å¤´æ–‡ä»¶çœ‹ä¸€ä¸‹ç°ä»£çš„<code>Objective-c</code>&ndash;<code>__attribute__</code>è¢«å¤§é‡ä½¿ç”¨ã€‚ï¼ˆç›¸åï¼Œ<code>#pragma</code>çš„ä¸»è¦å£°æ˜åå£°æ¥ç€è¿™äº›å¤©æ˜¯è£…é¥°:<code>#pragma mark</code>ï¼‰</p>

<p> æ‰€ä»¥ä¸ºäº†ä»¥åä¸è´¹åŠ›ï¼Œæˆ‘ä»¬è¿˜æ˜¯å…ˆçœ‹ä¸€ä¸‹æœ€é‡è¦çš„å±æ€§ï¼š</p>

<hr />

<h2>GCC</h2>

<p><strong>format</strong></p>

<blockquote><p><code>format</code>å±æ€§æŒ‡å®šäº†ä¸€ä¸ªå‡½æ•°åƒ<code>printf</code>,<code>scanf</code>,<code>strftime</code>æˆ–è€…<code>strfmo</code>é£æ ¼çš„å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°åº”è¯¥æ˜¯å¯ä»¥è¿›è¡Œç±»å‹æ£€æŸ¥çš„ä¸€ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚</p></blockquote>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="k">extern</span> <span class="kt">int</span>
</span><span class='line'><span class="nf">my_printf</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">my_object</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">my_format</span><span class="p">,</span> <span class="p">...)</span>
</span><span class='line'>  <span class="n">__attribute__</span><span class="p">((</span><span class="n">format</span><span class="p">(</span><span class="n">printf</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)));</span>
</span></code></pre></td></tr></table></div></figure>


<p>Objective-Cç¨‹åºå‘˜ä¹Ÿå¯ä½¿ç”¨<code>__NSString__</code>æ¥æ ¼å¼åŒ–æ¥åšåˆ°ç›¸åŒçš„æ ¼å¼åŒ–è§„åˆ™ï¼Œåƒåœ¨<code>NNString</code>ä¸­é€šè¿‡ <code>+stringWithFormat:</code> å’Œ <code>NSLog()</code>æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸€æ ·ã€‚</p>

<p><strong>nonnull</strong></p>

<blockquote><p>è¿™ä¸ª<code>nonnull</code>å±æ€§æŒ‡å®šäº†æŸäº›å‡½æ•°çš„å‚æ•°å¿…é¡»æ˜¯éç©ºçš„æŒ‡é’ˆã€‚</p></blockquote>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="k">extern</span> <span class="kt">void</span> <span class="o">*</span>
</span><span class='line'><span class="nf">my_memcpy</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">dest</span><span class="p">,</span> <span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">len</span><span class="p">)</span>
</span><span class='line'>  <span class="n">__attribute__</span><span class="p">((</span><span class="n">nonnull</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)));</span>
</span></code></pre></td></tr></table></div></figure>


<p>ä½¿ç”¨<code>nonnull</code>ç¼–ç æœŸæœ›è¿™ä¸ªå€¼éµå®ˆä¸€ä¸ªæ˜ç¡®çš„çº¦å®šä¸­ï¼Œè¿™æ ·èƒ½å¸®åŠ©æ•è·æ½œä¼åœ¨ä»»ä½•ä»£ç è°ƒç”¨çš„NULLæŒ‡é’ˆbugsï¼Œè¯·è®°ä½ï¼š
<code>ç¼–è¯‘æ—¶çš„é”™è¯¯ &gt;&gt;  è¿è¡Œæ—¶çš„é”™è¯¯ã€‚</code></p>

<p><strong>noreturn</strong></p>

<blockquote><p>ä¸€äº›æ ‡å‡†åº“å‡½æ•°ï¼Œä¾‹å¦‚<code>abort</code>å’Œ<code>exit</code>,æ˜¯ä¸èƒ½è¿”å›çš„ã€‚GCCè‡ªåŠ¨çŸ¥é“è¿™äº›ä¸œè¥¿ï¼Œè¿™ä¸ªnoreturnå±æ€§ç”¨äºæŒ‡å®šä»»ä½•å…¶ä»–å‡½æ•°æ°¸è¿œä¸ä¼šè¿”å›çš„æƒ…å†µã€‚</p></blockquote>

<p>ä¾‹å¦‚ï¼ŒAFNetworking ä½¿ç”¨<code>noreturn</code>å±æ€§åœ¨å®ƒçš„<a href="https://github.com/AFNetworking/AFNetworking/blob/1.1.0/AFNetworking/AFURLConnectionOperation.m#L157">ç½‘ç»œè¯·æ±‚çº¿ç¨‹è¿›å…¥ç‚¹çš„æ–¹æ³•</a>é‡Œé¢,è¿™ä¸ªæ–¹æ³•ç”¨åœ¨å½“å¤§é‡äº§ç”Ÿä¸“ç”¨çš„ç½‘ç»œçš„çº¿ç¨‹é‡Œç”¨æ¥ä¿è¯åˆ†ç¦»çš„çº¿ç¨‹æŒç»­æ‰§è¡Œåœ¨åº”ç”¨çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­ã€‚</p>

<p><strong>pure/const</strong></p>

<blockquote><p><code>pure</code>å±æ€§æŒ‡å®šäº†ä¸€ä¸ªå‡½æ•°é™¤äº†è¿”å›å€¼æ²¡æœ‰å‰¯ä½œç”¨ï¼Œä¾‹å¦‚å®ƒçš„è¿”å›å€¼ä»…ä»…ä¾èµ–å‚æ•°å’Œ/æˆ–è€…å…¨å±€å˜é‡ã€‚è¿™æ ·çš„å‡½æ•°å¯ä»¥ç”¨å…¬å…±å­è¡¨è¾¾å¼æ¶ˆé™¤å¹¶ä¸”å¾ªç¯ä¼˜åŒ–å°±åƒä¸€ä¸ªç®—æ•°æ“ä½œç¬¦é‚£æ ·ã€‚</p>

<p><code>pure</code>å±æ€§æŒ‡å®šäº†ä¸€ä¸ªå‡½æ•°ä¸ä¼šæ£€æŸ¥ä»»ä½•å€¼é™¤äº†å®ƒä»¬çš„å‚æ•°ï¼Œå¹¶ä¸”è¿”å›å€¼æ²¡æœ‰å‰¯ä½œç”¨ã€‚æ³¨æ„åˆ°ä¸€ä¸ªå‡½æ•°æœ‰ä¸€ä¸ªæŒ‡é’ˆå‚æ•°å¹¶ä¸”éœ€å‘€æ£€æŸ¥æ•°æ®çš„æŒ‡å‘ä¸èƒ½å£°æ˜æˆ<code>const</code>ã€‚åŒæ ·çš„ï¼Œä¸€ä¸ªå‡½æ•°è°ƒç”¨ä¸€ä¸ªé<code>nonst</code>å‡½æ•°é€šå¸¸ä¸èƒ½ä¸º<code>const</code>,ä¸€ä¸ª<code>const</code>å‡½æ•°è¿”å›<code>void</code>å¹¶æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰ã€‚</p></blockquote>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="kt">int</span> <span class="nf">square</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="n">__attribute__</span><span class="p">((</span><span class="k">const</span><span class="p">));</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>pure</code>å’Œ<code>const</code>æ˜¯ä¸¤ä¸ªæ‰§è¡Œåœ¨ä¸€ä¸ªå‡½æ•°å¼ç¼–ç¨‹æƒ¯ä¾‹ä¸­çš„å‚æ•°ä¸ºäº†å…è®¸æœ‰æ•ˆæ€§èƒ½ä¼˜åŒ–ã€‚<code>const</code>å¯ä»¥è¢«è®¤ä¸ºæ˜¯ä¸¥æ ¼å½¢å¼çš„<code>pure</code>å› ä¸ºå®ƒä¸ä¾èµ–å…¨å±€å˜é‡æˆ–è€…æŒ‡é’ˆã€‚</p>

<p>ä¾‹å¦‚ï¼Œå› ä¸ºä¸€ä¸ªå‡½æ•°å£°æ˜ä¸º<code>const</code>çš„ç»“æœå¹¶ä¸ä¾èµ–ä»»ä½•ä¸œè¥¿é™¤äº†ä¼ è¿›æ¥çš„å‚æ•°ã€‚å‡½æ•°çš„ç»“æœèƒ½å¤Ÿç¼“å­˜é‚£ä¸ªç»“æœå¹¶ä¸”å½“å‡½æ•°è¢«è°ƒç”¨æ—¶è¿”å›ï¼Œè¿™æ ·çš„å‡½æ•°å«åšç›¸åŒçš„ç»„åˆå‚æ•°ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬çŸ¥é“ä¸€ä¸ªæ•°å­—çš„å¹³æ–¹æ˜¯ä¸€ä¸ªå¸¸é‡ï¼Œæ‰€ä»¥æˆ‘ä»¬ä»…ä»…éœ€è¦åªè®¡ç®—å®ƒä¸€æ¬¡)ã€‚</p>

<p><strong>unused</strong></p>

<blockquote><p>è¿™ä¸ªå±æ€§ï¼Œé™„ç€åœ¨ä¸€ä¸ªå‡½æ•°åé¢ï¼Œæ„å‘³ç€é‚£ä¸ªå‡½æ•°å¾ˆå¯èƒ½ä¸ä¼šè¢«ä½¿ç”¨ï¼ŒGCCä¸ä¼šå¯¹è¿™ä¸ªå‡½æ•°äº§ç”Ÿè­¦å‘Šã€‚</p></blockquote>

<p>ç”¨<code>__unused</code>å…³é”®è¯å¯ä»¥è·å¾—ç›¸åŒçš„æ•ˆæœï¼Œå£°æ˜è¿™ä¸ªåœ¨æ–¹æ³•å®ç°ä¸­ä¸ä¼šè¢«ä½¿ç”¨çš„å‚æ•°ä¸­ã€‚çŸ¥é“é‚£ä»¥åä¸€äº›ä¸Šä¸‹æ–‡å°±å¯ä»¥å…è®¸ç¼–è¯‘å™¨æ¥åšç›¸åº”çš„ä¼˜åŒ–ã€‚ä½ å¾ˆå¯èƒ½å–œæ¬¢åœ¨delegateæ–¹æ³•å®ç°æå‹‰ä½¿ç”¨<code>__unused</code>,å› ä¸ºåè®®é¢‘ç¹çš„æé«˜æ›´å¤šçš„ä¸Šä¸‹æ–‡æ¯”é€šå¸¸å¿…è¦çš„æƒ…å†µï¼Œä¸ºäº†æ»¡è¶³å¤§é‡çš„æ½œåœ¨ä½¿ç”¨æ¡ˆä¾‹ã€‚</p>

<h3>LLVM</h3>

<p>åƒGCCçš„å¾ˆå¤šç‰¹å¾ä¸€æ ·ï¼ŒClangä¹Ÿæ”¯æŒ<code>__attribute__</code>,æ·»åŠ åˆ°å®ƒè‡ªå·±çš„å°èŒƒå›´çš„æ‰©å±•ã€‚ä¸ºäº†æ£€æŸ¥æŸä¸ªå±æ€§çš„å¯ç”¨æ€§ï¼Œä½ å¯ä»¥ç›´æ¥ä½¿ç”¨<code>__has_attribute</code>å±æ€§ã€‚</p>

<p><strong>availability</strong></p>

<blockquote><p>Clangå¼•è¿›äº†availabilityå±æ€§ï¼Œè¿™ä¸ªå¯ä»¥è¢«å–ä»£åœ¨å£°æ˜æè¿°çš„ç”Ÿå‘½å‘¨æœŸä¸­å£°æ˜ç›¸å¯¹äºæ“ä½œç³»ç»Ÿçš„ç‰ˆæœ¬ã€‚æ€è€ƒå¯¹ä¸€ä¸ªç®€å•å‡½æ•°fï¼šçš„å‡½æ•°å£°æ˜</p></blockquote>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="kt">void</span> <span class="nf">f</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">availability</span><span class="p">(</span><span class="n">macosx</span><span class="p">,</span><span class="n">introduced</span><span class="o">=</span><span class="mf">10.4</span><span class="p">,</span><span class="n">deprecated</span><span class="o">=</span><span class="mf">10.6</span><span class="p">,</span><span class="n">obsoleted</span><span class="o">=</span><span class="mf">10.7</span><span class="p">)));</span>
</span></code></pre></td></tr></table></div></figure>


<blockquote><p><code>availability</code>å±æ€§å£°æ˜fåœ¨OS Xè€è™ç³»ç»Ÿä¸­è¢«å¼•å…¥ï¼Œåœ¨OS Xé›ªè±¹ç³»ç»Ÿä¸­è¢«å¼ƒç”¨ï¼Œåœ¨OS X å±±ç‹®ç³»ç»Ÿä¸­è¢«åºŸå¼ƒã€‚</p>

<p>è¿™ä¸ªä¿¡æ¯è¢«Clangç”¨æ¥å†³å®šä»€ä¹ˆæ—¶å€™ä½¿ç”¨fï¼šå‡½æ•°å¼å®‰å…¨çš„ï¼Œä¾‹å¦‚ï¼Œå‡å¦‚Clangåœ¨OS X ç¾æ´²è±¹ç³»ç»Ÿä¸Šç¼–è¯‘ï¼Œè°ƒç”¨f()å‡½æ•°å°†æˆåŠŸã€‚å‡å¦‚Clangåœ¨OS Xé›ªè±¹ç³»ç»Ÿä¸­ç¼–è¯‘ï¼Œå‡½æ•°è°ƒç”¨å°†æˆåŠŸä½†æ˜¯Clangä¼šå‘å‡ºä¸€ä¸ªè­¦å‘ŠæŒ‡æ˜è¿™ä¸ªå‡½æ•°è¢«å¼ƒç”¨äº†ã€‚æœ€åï¼Œå‡å¦‚Clangè¢«å¼•è¿›ç¼–è¯‘OS Xå±±ç‹®ç³»ç»Ÿçš„ä»£ç ï¼Œå‡½æ•°è°ƒç”¨å°†å¤±è´¥ï¼Œå› ä¸ºf()å‡½æ•°å·²ç»ä¸å†å¯ç”¨äº†ã€‚</p>

<p><code>availability</code>å±æ€§æ˜¯ä¸€ä¸ªé€—å·åˆ†éš”çš„åˆ—è¡¨ä»¥å¹³å°åå¼€å§‹ç„¶åå¼•å…¥ä¸€äº›å®šè¯­åˆ—ä¸¾å‡ºç”Ÿå‘½å‘¨æœŸå†…çš„é‡è¦é‡Œç¨‹ç¢‘äº‹ä»¶é™„åŠ é¢å¤–çš„ä¿¡æ¯ï¼ˆä»¥ä»»ä½•é¡ºåºï¼‰ã€‚</p></blockquote>

<ul>
<li>introducedï¼šå£°æ˜è¢«å¼•å…¥çš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬</li>
<li>deprecatedï¼šå£°æ˜è¢«å¼ƒç”¨çš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬ï¼Œè¿™æ„å‘³ç€ç”¨æˆ·åº”è¯¥æŠŠè¿™ä¸ªAPIç§»èµ°</li>
<li>obsoletedï¼š å£°æ˜è¢«åºŸå¼ƒçš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬ï¼Œè¿™æ„å‘³ç€å®ƒå°†è¢«å®Œå…¨ç§»é™¤å¹¶ä¸”ä¸èƒ½å†ä½¿ç”¨</li>
<li>unavailableï¼šå£°æ˜åœ¨è¿™ä¸ªå¹³å°ä¸Šå°†æ°¸è¿œä¸å¯ç”¨</li>
<li>messageï¼šé¢å¤–çš„æ¶ˆæ¯å°†è¢«Clangæä¾›å½“å¿½ç•¥ä¸€ä¸ªè­¦å‘Šæˆ–è€…ä¸€ä¸ªé”™è¯¯åœ¨ä½¿ç”¨ä¸€ä¸ªè¢«å¼ƒç”¨æˆ–è€…è¢«åºŸå¼ƒçš„å£°æ˜ã€‚å¯¹å¼•å¯¼ç”¨æˆ·æ›¿æ¢APIså¾ˆæœ‰ç”¨ã€‚</li>
</ul>


<blockquote><p>åœ¨å£°æ˜æ—¶å¯ä»¥ä½¿ç”¨å¤šä¸ªavailabilityå±æ€§ï¼Œæ¯ä¸ªå¯¹åº”ä¸åŒçš„å¹³å°ï¼Œä»…å½“availabilityå±æ€§å¯¹åº”ç›¸åº”çš„ç›®æ ‡å¹³å°è¢«ä½¿ç”¨çš„æ—¶å€™ï¼Œä»»ä½•å…¶ä»–æ‰å°†è¢«å¿½ç•¥ã€‚å‡å¦‚æ²¡æœ‰availability å±æ€§æŒ‡å®šå¯ç”¨æ€§å¯¹ç°åœ¨çš„ç›®æ ‡å¹³å°ï¼Œavailability å±æ€§å°†è¢«å¿½ç•¥ã€‚</p></blockquote>

<h4>æ”¯æŒçš„å¹³å°ï¼š</h4>

<ul>
<li>iosï¼šè‹¹æœçš„iOSæ“ä½œç³»ç»Ÿã€‚æœ€å°çš„éƒ¨ç½²ç›®æ ‡è¢«æŒ‡å®šé€šè¿‡<code>-mios-version-min=*version*</code>æˆ–è€…<code>-miphoneos-version-min=*version*</code>å‘½ä»¤è¡Œå‚æ•°ã€‚</li>
<li>macosxï¼šè‹¹æœçš„OS X æ“ä½œç³»ç»Ÿï¼Œæœ€å°çš„éƒ¨ç½²ç›®æ ‡è¢«æŒ‡å®šé€šè¿‡<code>-mmacosx-version-min=*version*</code>å‘½ä»¤è¡Œå‚æ•°</li>
</ul>


<p><strong>overloadable</strong></p>

<blockquote><p>Clangæä¾›å¯¹C++å‡½æ•°åœ¨Cä¸­é‡è½½çš„æ”¯æŒã€‚åœ¨Cä¸­å‡½æ•°é‡è½½è¢«å¼•è¿›ä½¿ç”¨<code>overloadable</code>å±æ€§ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªå¯èƒ½æä¾›ä¸€ä¸ªé‡è½½ç‰ˆæœ¬çš„<code>tgsin</code>å‡½æ•°æ¥ç²¾ç¡®æ‰§è¡Œç›¸å…³çš„æ ‡å‡†å‡½æ•°è®¡ç®—<code>float</code>,<code>double</code>,<code>long double</code>çš„æ­£å¼¦å€¼ï¼š</p></blockquote>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="cp">#include &lt;math.h&gt;</span>
</span><span class='line'><span class="kt">float</span> <span class="nf">__attribute__</span><span class="p">((</span><span class="n">overloadable</span><span class="p">))</span> <span class="n">tgsin</span><span class="p">(</span><span class="kt">float</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">sinf</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="p">}</span>
</span><span class='line'><span class="kt">double</span> <span class="nf">__attribute__</span><span class="p">((</span><span class="n">overloadable</span><span class="p">))</span> <span class="n">tgsin</span><span class="p">(</span><span class="kt">double</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="p">}</span>
</span><span class='line'><span class="kt">long</span> <span class="kt">double</span> <span class="nf">__attribute__</span><span class="p">((</span><span class="n">overloadable</span><span class="p">))</span> <span class="n">tgsin</span><span class="p">(</span><span class="kt">long</span> <span class="kt">double</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">sinl</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>è¯·æ³¨æ„<code>overloadable</code>åªå¯¹å‡½æ•°èµ·ä½œç”¨ã€‚ä½ å¯ä»¥é‡è½½æ–¹æ³•å£°æ˜åœ¨æŸç§èŒƒå›´å†…é€šè¿‡ä½¿ç”¨é€šç”¨çš„è¿”å›å€¼å’Œå‚æ•°ç±»å‹ï¼Œæƒ³<code>id</code>æˆ–è€…<code>void *</code>.</p>

<hr />

<p>ä¸Šä¸‹æ–‡æ˜¯å›½ç‹å½“å®ƒé‡åˆ°ç¼–è¯‘å™¨ä¼˜åŒ–æ—¶ã€‚é€šè¿‡æä¾›é™åˆ¶åœ¨æ€æ ·è§£æä½ çš„ä»£ç ï¼Œå¢åŠ ä½ å‚æ•°å°½å¯èƒ½é«˜æ•ˆä»£ç çš„å¯èƒ½æ€§ã€‚é‡åˆ°ç¼–è¯‘å™¨æŠŠä½ æ‰“æ–­ï¼Œè¿™å°†æ˜¯ä¸€é¡¹å¥–åŠ±ã€‚</p>

<p>è¿˜æœ‰<code>__attribute__</code>å¹¶ä¸ä»…ä»…å¯¹ç¼–è¯‘å™¨æœ‰ç”¨ï¼šä¸‹ä¸€ä¸ªäººçœ‹ä»£ç ä¹Ÿå°†æ„Ÿè°¢è¿™äº›é¢å¤–çš„ä¸Šä¸‹æ–‡ã€‚æ‰€ä»¥å¤šèµ°å‡ è‹±å°ºè¿œå°†å¯¹ä½ çš„åˆä½œä¸­å’Œæ¥æ›¿è€…æˆ–è€…ä»ç°åœ¨ç®—2å¹´ä»¥åçš„ä½ (é‚£ä¸ªæ—¶å€™ä½ å·²ç»å¿˜è®°äº†æ‰€ä»¥çš„äº‹æƒ…å…³äºè¿™ä»½ä»£ç )è‡ªå·±æœ‰ç”¨</p>

<p>ä½ ä»˜å‡ºäº†å¤šå°‘çˆ±,æœ€ç»ˆä½ ä¼šå¾—åˆ°å¤šå°‘çˆ±ã€‚</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[å¤šçº¿ç¨‹ä¹‹NSThread]]></title>
    <link href="http://wangruofeng.github.io/blog/2016/01/13/duo-xian-cheng-zhi-nsthread/"/>
    <updated>2016-01-13T03:35:48+08:00</updated>
    <id>http://wangruofeng.github.io/blog/2016/01/13/duo-xian-cheng-zhi-nsthread</id>
    <content type="html"><![CDATA[<h2>æœ¬æ–‡ç›®å½•</h2>

<ul>
<li>å‰è¨€</li>
<li>1.è·å–å½“å‰çº¿ç¨‹</li>
<li>2.è·å–ä¸»çº¿ç¨‹</li>
<li>3.NSThreadçš„åˆ›å»º</li>
<li>4.æš‚åœå½“å‰çº¿ç¨‹</li>
<li>5.çº¿ç¨‹çš„å…¶ä»–æ“ä½œ</li>
<li>6.ä¼˜ç¼ºç‚¹</li>
</ul>


<h3>å‰è¨€</h3>

<p>æ¯ä¸ªiOSåº”ç”¨ç¨‹åºéƒ½æœ‰ä¸ªä¸“é—¨ç”¨æ¥æ›´æ–°æ˜¾ç¤ºUIç•Œé¢ã€å¤„ç†ç”¨æˆ·è§¦æ‘¸äº‹ä»¶çš„ä¸»çº¿ç¨‹ï¼Œå› æ­¤ä¸èƒ½å°†å…¶ä»–å¤ªè€—æ—¶çš„æ“ä½œæ”¾åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œä¸ç„¶ä¼šé€ æˆä¸»çº¿ç¨‹å µå¡(å‡ºç°å¡æœºç°è±¡)ï¼Œå¸¦æ¥æåçš„ç”¨æˆ·ä½“éªŒã€‚ä¸€èˆ¬çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯å°†é‚£äº›è€—æ—¶çš„æ“ä½œæ”¾åˆ°å¦å¤–ä¸€ä¸ªçº¿ç¨‹ä¸­å»æ‰§è¡Œï¼Œå¤šçº¿ç¨‹ç¼–ç¨‹æ˜¯é˜²æ­¢ä¸»çº¿ç¨‹å µå¡ï¼Œå¢åŠ è¿è¡Œæ•ˆç‡çš„æœ€ä½³æ–¹æ³•ã€‚</p>

<p>iOSä¸­æœ‰3ç§å¸¸è§çš„å¤šçº¿ç¨‹ç¼–ç¨‹æ–¹æ³•
1. <code>NSThread</code>
è¿™ç§æ–¹æ³•éœ€è¦ç®¡ç†çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸã€åŒæ­¥ã€åŠ é”é—®é¢˜ï¼Œä¼šå¯¼è‡´ä¸€å®šçš„æ€§èƒ½å¼€é”€</p>

<ol>
<li><p><code>NSOperation</code>å’Œ<code>NSOperationQueue</code>
æ˜¯åŸºäºOCå®ç°çš„ã€‚NSOperationä»¥é¢å‘å¯¹è±¡çš„æ–¹å¼å°è£…äº†éœ€è¦æ‰§è¡Œçš„æ“ä½œï¼Œç„¶åå¯ä»¥å°†è¿™ä¸ªæ“ä½œæ”¾åˆ°ä¸€ä¸ªNSOperationQueueä¸­å»å¼‚æ­¥æ‰§è¡Œã€‚ä¸å¿…å…³å¿ƒçº¿ç¨‹ç®¡ç†ã€åŒæ­¥ç­‰é—®é¢˜ã€‚</p></li>
<li><p><code>Grand Centeral Dispatch</code>
ç®€ç§°GCDï¼ŒiOS4æ‰å¼€å§‹æ”¯æŒï¼Œæ˜¯çº¯Cè¯­è¨€çš„APIã€‚è‡ªiPad2å¼€å§‹ï¼Œè‹¹æœè®¾å¤‡å¼€å§‹æœ‰äº†åŒæ ¸CPUï¼Œä¸ºäº†å……åˆ†åˆ©ç”¨è¿™2ä¸ªæ ¸ï¼ŒGCDæä¾›äº†ä¸€äº›æ–°ç‰¹æ€§æ¥æ”¯æŒå¤šæ ¸å¹¶è¡Œç¼–ç¨‹</p></li>
</ol>


<p>è¿™ç¯‡æ–‡ç« ç®€å•ä»‹ç»<code>NSThreadè¿™</code>ä¸ªç±»ï¼Œä¸€ä¸ª<code>NSThread</code>å®ä¾‹å°±ä»£è¡¨ç€ä¸€æ¡çº¿ç¨‹</p>

<h3>1.è·å–å½“å‰çº¿ç¨‹</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="bp">NSThread</span> <span class="o">*</span><span class="n">current</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSThread</span> <span class="n">currentThread</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<h3>2.è·å–ä¸»çº¿ç¨‹</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="bp">NSThread</span> <span class="o">*</span><span class="n">main</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSThread</span> <span class="n">mainThread</span><span class="p">];</span>
</span><span class='line'><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;ä¸»çº¿ç¨‹:%@&quot;</span><span class="p">,</span> <span class="n">main</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>æ‰“å°ç»“æœæ˜¯ï¼š</p>

<pre><code>2013-04-18 21:36:38.599 thread[7499:c07] ä¸»çº¿ç¨‹:&lt;NSThread: 0x71434e0&gt;{name = (null), num = 1}
</code></pre>

<p>numç›¸å½“äºçº¿ç¨‹çš„idï¼Œä¸»çº¿ç¨‹çš„numæ˜¯ä¸º1çš„</p>

<h3>3.NSThreadçš„åˆ›å»º</h3>

<h4>a.åŠ¨æ€æ–¹æ³•</h4>

<pre><code>- (id)initWithTarget:(id)target selector:(SEL)selector object:(id)argument;
</code></pre>

<p>åœ¨ç¬¬2è¡Œåˆ›å»ºäº†ä¸€æ¡æ–°çº¿ç¨‹ï¼Œç„¶ååœ¨ç¬¬4è¡Œè°ƒç”¨<code>start</code>æ–¹æ³•å¯åŠ¨çº¿ç¨‹ï¼Œçº¿ç¨‹å¯åŠ¨åä¼šè°ƒç”¨selfçš„<code>run:</code>æ–¹æ³•ï¼Œå¹¶ä¸”å°†@&ldquo;mj"ä½œä¸ºæ–¹æ³•å‚æ•°</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="c1">// åˆå§‹åŒ–çº¿ç¨‹</span>
</span><span class='line'><span class="bp">NSThread</span> <span class="o">*</span><span class="kr">thread</span> <span class="o">=</span> <span class="p">[[[</span><span class="bp">NSThread</span> <span class="n">alloc</span><span class="p">]</span> <span class="nl">initWithTarget</span><span class="p">:</span><span class="nb">self</span> <span class="nl">selector</span><span class="p">:</span><span class="k">@selector</span><span class="p">(</span><span class="nl">run</span><span class="p">:)</span> <span class="nl">object</span><span class="p">:</span><span class="s">@&quot;mj&quot;</span><span class="p">]</span> <span class="n">autorelease</span><span class="p">];</span>
</span><span class='line'><span class="c1">// å¼€å¯çº¿ç¨‹</span>
</span><span class='line'><span class="p">[</span><span class="kr">thread</span> <span class="n">start</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>å‡å¦‚run:æ–¹æ³•æ˜¯è¿™æ ·çš„ï¼š</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">run:</span><span class="p">(</span><span class="bp">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">string</span> <span class="p">{</span>
</span><span class='line'>     <span class="bp">NSThread</span> <span class="o">*</span><span class="n">current</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSThread</span> <span class="n">currentThread</span><span class="p">];</span>
</span><span class='line'>     <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;æ‰§è¡Œäº†run:æ–¹æ³•-å‚æ•°ï¼š%@ï¼Œå½“å‰çº¿ç¨‹ï¼š%@&quot;</span><span class="p">,</span> <span class="n">string</span><span class="p">,</span> <span class="n">current</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>æ‰“å°ç»“æœä¸ºï¼š</p>

<pre><code>2013-04-18 21:40:33.102 thread[7542:3e13] æ‰§è¡Œäº†run:æ–¹æ³•-å‚æ•°ï¼šmjï¼Œå½“å‰çº¿ç¨‹ï¼š&lt;NSThread: 0x889e8d0&gt;{name = (null), num = 3}
</code></pre>

<p>å¯ä»¥å‘ç°ï¼Œè¿™æ¡çº¿ç¨‹çš„numå€¼ä¸º3ï¼Œè¯´æ˜ä¸æ˜¯ä¸»çº¿ç¨‹ï¼Œä¸»çº¿ç¨‹çš„numä¸º1</p>

<h4>b.é™æ€æ–¹æ³•</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">+</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">detachNewThreadSelector:</span><span class="p">(</span><span class="kt">SEL</span><span class="p">)</span><span class="nv">selector</span> <span class="nf">toTarget:</span><span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nv">target</span> <span class="nf">withObject:</span><span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nv">argument</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">[</span><span class="bp">NSThread</span> <span class="nl">detachNewThreadSelector</span><span class="p">:</span><span class="k">@selector</span><span class="p">(</span><span class="nl">run</span><span class="p">:)</span> <span class="nl">toTarget</span><span class="p">:</span><span class="nb">self</span> <span class="nl">withObject</span><span class="p">:</span><span class="s">@&quot;mj&quot;</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<h4>c.éšå¼åˆ›å»ºçº¿ç¨‹</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">[</span><span class="nb">self</span> <span class="nl">performSelectorInBackground</span><span class="p">:</span><span class="k">@selector</span><span class="p">(</span><span class="nl">run</span><span class="p">:)</span> <span class="nl">withObject</span><span class="p">:</span><span class="s">@&quot;mj&quot;</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<p>ä¼šéšå¼åœ°åˆ›å»ºä¸€æ¡æ–°çº¿ç¨‹ï¼Œå¹¶ä¸”åœ¨è¿™æ¡çº¿ç¨‹ä¸Šè°ƒç”¨selfçš„run:æ–¹æ³•ï¼Œä»¥@&ldquo;mj"ä¸ºæ–¹æ³•å‚æ•°</p>

<h3>4.æš‚åœå½“å‰çº¿ç¨‹</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">[</span><span class="bp">NSThread</span> <span class="nl">sleepForTimeInterval</span><span class="p">:</span><span class="mi">2</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="bp">NSDate</span> <span class="o">*</span><span class="n">date</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSDate</span> <span class="nl">dateWithTimeInterval</span><span class="p">:</span><span class="mi">2</span> <span class="nl">sinceDate</span><span class="p">:[</span><span class="bp">NSDate</span> <span class="n">date</span><span class="p">]];</span>
</span><span class='line'><span class="p">[</span><span class="bp">NSThread</span> <span class="nl">sleepUntilDate</span><span class="p">:</span><span class="n">date</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<p>ä¸Šé¢ä¸¤ç§åšæ³•éƒ½æ˜¯æš‚åœå½“å‰çº¿ç¨‹2ç§’</p>

<h3>5.çº¿ç¨‹çš„å…¶ä»–æ“ä½œ</h3>

<h4>a.åœ¨æŒ‡å®šçº¿ç¨‹ä¸Šæ‰§è¡Œæ“ä½œ</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'> <span class="p">[</span><span class="nb">self</span> <span class="nl">performSelector</span><span class="p">:</span><span class="k">@selector</span><span class="p">(</span><span class="n">run</span><span class="p">)</span> <span class="nl">onThread</span><span class="p">:</span><span class="kr">thread</span> <span class="nl">withObject</span><span class="p">:</span><span class="nb">nil</span> <span class="nl">waitUntilDone</span><span class="p">:</span><span class="nb">YES</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>ä¸Šé¢ä»£ç çš„æ„æ€æ˜¯åœ¨threadè¿™æ¡çº¿ç¨‹ä¸Šè°ƒç”¨selfçš„runæ–¹æ³•</li>
<li>æœ€åçš„YESä»£è¡¨ï¼šä¸Šé¢çš„ä»£ç ä¼šé˜»å¡ï¼Œç­‰runæ–¹æ³•åœ¨threadçº¿ç¨‹æ‰§è¡Œå®Œæ¯•åï¼Œä¸Šé¢çš„ä»£ç æ‰ä¼šé€šè¿‡</li>
</ul>


<h4>b.åœ¨ä¸»çº¿ç¨‹ä¸Šæ‰§è¡Œæ“ä½œ</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">[</span><span class="nb">self</span> <span class="nl">performSelectorOnMainThread</span><span class="p">:</span><span class="k">@selector</span><span class="p">(</span><span class="n">run</span><span class="p">)</span> <span class="nl">withObject</span><span class="p">:</span><span class="nb">nil</span> <span class="nl">waitUntilDone</span><span class="p">:</span><span class="nb">YES</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<p>åœ¨ä¸»çº¿ç¨‹è°ƒç”¨selfçš„runæ–¹æ³•</p>

<h4>c.åœ¨å½“å‰çº¿ç¨‹æ‰§è¡Œæ“ä½œ</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">[</span><span class="nb">self</span> <span class="nl">performSelector</span><span class="p">:</span><span class="k">@selector</span><span class="p">(</span><span class="n">run</span><span class="p">)</span> <span class="nl">withObject</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<p>åœ¨å½“å‰çº¿ç¨‹è°ƒç”¨selfçš„runæ–¹æ³•</p>

<h3>6.ä¼˜ç¼ºç‚¹</h3>

<ol>
<li>ä¼˜ç‚¹ï¼š<code>NSThread</code>æ¯”å…¶ä»–å¤šçº¿ç¨‹æ–¹æ¡ˆè¾ƒè½»é‡çº§ï¼Œæ›´ç›´è§‚åœ°æ§åˆ¶çº¿ç¨‹å¯¹è±¡</li>
<li>ç¼ºç‚¹ï¼šéœ€è¦è‡ªå·±ç®¡ç†çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸï¼Œçº¿ç¨‹åŒæ­¥ã€‚çº¿ç¨‹åŒæ­¥å¯¹æ•°æ®çš„åŠ é”ä¼šæœ‰ä¸€å®šçš„ç³»ç»Ÿå¼€é”€</li>
</ol>

]]></content>
  </entry>
  
</feed>
